
/*****
*
* Copyright (C) 2001-2016 CS-SI. All Rights Reserved.
* Author: Yoann Vandoorselaere <yoann.v@prelude-ids.com>
* Author: Nicolas Delon <nicolas.delon@prelude-ids.com>
*
* This file is part of the Libiodefv2 library.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2, or (at your option)
* any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License along
* with this program; if not, write to the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
*****/

/*
 * This file was automatically generated by our generator, version 1
 *
 * Do not make changes to this file unless you know what you are doing.
 * modify the template interface file instead.
 * IODEFV2 version : RFC5070-bis-26
 * Template file: generate-top-level-class-read.c.mako
 *
 */

#include "config.h"

#include <stdio.h>
#include <unistd.h>

#define LIBIODEFV2_ERROR_SOURCE_DEFAULT LIBIODEFV2_ERROR_SOURCE_IODEFV2_MESSAGE_READ
#include "libiodefv2-error.h"
#include "libiodefv2-inttypes.h"
#include "libiodefv2-list.h"
#include "libiodefv2-extract.h"
#include "libiodefv2-io.h"
#include "iodefv2-message-id.h"
#include "iodefv2.h"
#include "iodefv2-tree-wrap.h"

#include "iodefv2-message-read.h"

#define libiodefv2_extract_string_safe(out, buf, len, msg) extract_string_safe_f(__FUNCTION__, __LINE__, out, buf, len)

static inline int extract_string_safe_f(const char *f, int line, libiodefv2_string_t **out, char *buf, size_t len)
{
        int ret;

        /*
         * we use len - 1 since len is supposed to include \0 to avoid making a dup.
         */
        ret = libiodefv2_string_new_ref_fast(out, buf, len - 1);
        if ( ret < 0 )
                ret = libiodefv2_error_verbose(libiodefv2_error_get_code(ret), "%s:%d could not extract IODEFV2 string: %s", f, line, libiodefv2_strerror(ret));

        return ret;
}


static inline int libiodefv2_extract_time_safe(iodefv2_time_t **out, void *buf, size_t len, libiodefv2_msg_t *msg)
{
        int ret;

        /*
         * sizeof(sec) + sizeof(usec) + sizeof(gmt offset).
         */
        if ( len != 12 )
                return libiodefv2_error_make(LIBIODEFV2_ERROR_SOURCE_EXTRACT, LIBIODEFV2_ERROR_INVAL_IODEFV2_TIME);

        ret = iodefv2_time_new(out);
        if ( ret < 0 )
                return ret;

        iodefv2_time_set_sec(*out, libiodefv2_extract_uint32(buf));
        iodefv2_time_set_usec(*out, libiodefv2_extract_uint32((unsigned char *) buf + 4));
        iodefv2_time_set_gmt_offset(*out, libiodefv2_extract_int32((unsigned char *) buf + 8));

        return 0;
}


static inline int libiodefv2_extract_data_safe(iodefv2_data_t **out, void *buf, uint32_t len, libiodefv2_msg_t *msg)
{
        int ret;
        uint8_t tag;
        iodefv2_data_type_t type = 0;

        ret = libiodefv2_extract_uint32_safe(&type, buf, len);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
        if ( ret < 0 )
                return ret;

        *out = NULL;

        switch ( type ) {
        case IODEFV2_DATA_TYPE_CHAR: {
                uint8_t tmp = 0;

                ret = libiodefv2_extract_uint8_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_char(out, (char) tmp);
                break;
        }

        case IODEFV2_DATA_TYPE_BYTE: {
                uint8_t tmp = 0;

                ret = libiodefv2_extract_uint8_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_byte(out, tmp);
                break;
        }

        case IODEFV2_DATA_TYPE_UINT32: {
                uint32_t tmp = 0;

                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_int(out, tmp);
                break;
        }

        case IODEFV2_DATA_TYPE_INT: {
                uint64_t tmp = 0;

                ret = libiodefv2_extract_uint64_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_int(out, tmp);
                break;
        }

        case IODEFV2_DATA_TYPE_FLOAT: {
                float tmp = 0;

                ret = libiodefv2_extract_float_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_float(out, tmp);
                break;
        }

        case IODEFV2_DATA_TYPE_BYTE_STRING: {
                ret = iodefv2_data_new_ptr_ref_fast(out, type, buf, len);
                break;
        }

        case IODEFV2_DATA_TYPE_CHAR_STRING: {
                const char *tmp = NULL;

                ret = libiodefv2_extract_characters_safe(&tmp, buf, len);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_ptr_ref_fast(out, type, tmp, len);
                break;
        }

        case IODEFV2_DATA_TYPE_TIME: {
                iodefv2_time_t *time;

                ret = libiodefv2_extract_time_safe(&time, buf, len, msg);
                if ( ret < 0 )
                        return ret;

                ret = iodefv2_data_new_time(out, time);
                break;
        }

        case IODEFV2_DATA_TYPE_UNKNOWN:
                /* nop */;
        }

        return ret;
}

/**
 * iodefv2_telephone_read:
 * @telephone: Pointer to a #iodefv2_telephone_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_telephone from the @msg message, and
 * store it into @telephone.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_telephone_read(iodefv2_telephone_t *telephone, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_TELEPHONE_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_telephone_set_type(telephone, tmp);
                                break;
                        }




                        case IODEFV2_MSG_TELEPHONE_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_telephone_set_ext_type(telephone, tmp);
                                break;
                        }



                        case IODEFV2_MSG_TELEPHONE_TELEPHONE_NUMBER : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_telephone_set_telephone_number(telephone, tmp);
                                break;
                        }



                        case IODEFV2_MSG_TELEPHONE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_telephone_set_description(telephone, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_telephone_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_certificate_read:
 * @certificate: Pointer to a #iodefv2_certificate_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_certificate from the @msg message, and
 * store it into @certificate.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_certificate_read(iodefv2_certificate_t *certificate, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_CERTIFICATE_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_set_observable_id(certificate, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CERTIFICATE_X509_DATA : {
                                iodefv2_data_t *tmp = NULL;

                                ret = libiodefv2_extract_data_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_set_x509_data(certificate, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CERTIFICATE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_set_description(certificate, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_certificate_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_key_read:
 * @key: Pointer to a #iodefv2_key_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_key from the @msg message, and
 * store it into @key.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_key_read(iodefv2_key_t *key, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_KEY_REGISTRYACTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_key_set_registryaction(key, tmp);
                                break;
                        }




                        case IODEFV2_MSG_KEY_EXT_REGISTRYACTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_key_set_ext_registryaction(key, tmp);
                                break;
                        }



                        case IODEFV2_MSG_KEY_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_key_set_observable_id(key, tmp);
                                break;
                        }



                        case IODEFV2_MSG_KEY_KEY_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_key_set_key_name(key, tmp);
                                break;
                        }



                        case IODEFV2_MSG_KEY_KEY_VALUE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_key_set_key_value(key, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_key_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_observable_reference_read:
 * @observable_reference: Pointer to a #iodefv2_observable_reference_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_observable_reference from the @msg message, and
 * store it into @observable_reference.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_observable_reference_read(iodefv2_observable_reference_t *observable_reference, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_OBSERVABLE_REFERENCE_UID_REF : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_observable_reference_set_uid_ref(observable_reference, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_observable_reference_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_registry_handle_read:
 * @registry_handle: Pointer to a #iodefv2_registry_handle_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_registry_handle from the @msg message, and
 * store it into @registry_handle.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_registry_handle_read(iodefv2_registry_handle_t *registry_handle, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_REGISTRY_HANDLE_REGISTRY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_registry_handle_set_registry(registry_handle, tmp);
                                break;
                        }




                        case IODEFV2_MSG_REGISTRY_HANDLE_EXT_REGISTRY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_registry_handle_set_ext_registry(registry_handle, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_registry_handle_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_time_impact_read:
 * @time_impact: Pointer to a #iodefv2_time_impact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_time_impact from the @msg message, and
 * store it into @time_impact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_time_impact_read(iodefv2_time_impact_t *time_impact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_TIME_IMPACT_EXT_METRIC : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_time_impact_set_ext_metric(time_impact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_TIME_IMPACT_DURATION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_time_impact_set_duration(time_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_TIME_IMPACT_METRIC : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_time_impact_set_metric(time_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_TIME_IMPACT_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_time_impact_set_severity(time_impact, tmp);
                                break;
                        }




                        case IODEFV2_MSG_TIME_IMPACT_EXT_DURATION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_time_impact_set_ext_duration(time_impact, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_time_impact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_record_pattern_read:
 * @record_pattern: Pointer to a #iodefv2_record_pattern_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_record_pattern from the @msg message, and
 * store it into @record_pattern.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_pattern_read(iodefv2_record_pattern_t *record_pattern, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_RECORD_PATTERN_INSTANCE : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_instance(record_pattern, tmp);
                                break;
                        }



                        case IODEFV2_MSG_RECORD_PATTERN_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_ext_type(record_pattern, tmp);
                                break;
                        }



                        case IODEFV2_MSG_RECORD_PATTERN_OFFSET : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_offset(record_pattern, tmp);
                                break;
                        }


                        case IODEFV2_MSG_RECORD_PATTERN_OFFSETUNIT : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_offsetunit(record_pattern, tmp);
                                break;
                        }




                        case IODEFV2_MSG_RECORD_PATTERN_EXT_OFFSETUNIT : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_ext_offsetunit(record_pattern, tmp);
                                break;
                        }


                        case IODEFV2_MSG_RECORD_PATTERN_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_pattern_set_type(record_pattern, tmp);
                                break;
                        }


                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_record_pattern_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_reference_read:
 * @reference: Pointer to a #iodefv2_reference_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_reference from the @msg message, and
 * store it into @reference.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_reference_read(iodefv2_reference_t *reference, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_REFERENCE_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_reference_set_observable_id(reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_REFERENCE_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_reference_set_url(reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_REFERENCE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_reference_set_description(reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_REFERENCE_REFERENCE_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_reference_set_reference_name(reference, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_reference_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_postal_address_read:
 * @postal_address: Pointer to a #iodefv2_postal_address_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_postal_address from the @msg message, and
 * store it into @postal_address.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_postal_address_read(iodefv2_postal_address_t *postal_address, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_POSTAL_ADDRESS_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_postal_address_set_type(postal_address, tmp);
                                break;
                        }




                        case IODEFV2_MSG_POSTAL_ADDRESS_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_postal_address_set_ext_type(postal_address, tmp);
                                break;
                        }



                        case IODEFV2_MSG_POSTAL_ADDRESS_P_ADDRESS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_postal_address_set_p_address(postal_address, tmp);
                                break;
                        }



                        case IODEFV2_MSG_POSTAL_ADDRESS_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_postal_address_set_description(postal_address, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_postal_address_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_node_role_read:
 * @node_role: Pointer to a #iodefv2_node_role_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_node_role from the @msg message, and
 * store it into @node_role.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_node_role_read(iodefv2_node_role_t *node_role, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_NODE_ROLE_CATEGORY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_node_role_set_category(node_role, tmp);
                                break;
                        }




                        case IODEFV2_MSG_NODE_ROLE_EXT_CATEGORY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_node_role_set_ext_category(node_role, tmp);
                                break;
                        }



                        case IODEFV2_MSG_NODE_ROLE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_node_role_set_description(node_role, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_node_role_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_incident_id_read:
 * @incident_id: Pointer to a #iodefv2_incident_id_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_incident_id from the @msg message, and
 * store it into @incident_id.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_incident_id_read(iodefv2_incident_id_t *incident_id, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_INCIDENT_ID_INSTANCE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_id_set_instance(incident_id, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_ID_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_id_set_ext_restriction(incident_id, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_ID_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_id_set_name(incident_id, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_ID_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_id_set_restriction(incident_id, tmp);
                                break;
                        }


                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_incident_id_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_alternative_indicator_id_read:
 * @alternative_indicator_id: Pointer to a #iodefv2_alternative_indicator_id_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_alternative_indicator_id from the @msg message, and
 * store it into @alternative_indicator_id.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_alternative_indicator_id_read(iodefv2_alternative_indicator_id_t *alternative_indicator_id, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_alternative_indicator_id_set_restriction(alternative_indicator_id, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_alternative_indicator_id_set_ext_restriction(alternative_indicator_id, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_INDICATOR_REFERENCE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_alternative_indicator_id_set_indicator_reference(alternative_indicator_id, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_alternative_indicator_id_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_confidence_read:
 * @confidence: Pointer to a #iodefv2_confidence_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_confidence from the @msg message, and
 * store it into @confidence.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_confidence_read(iodefv2_confidence_t *confidence, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_CONFIDENCE_RATING : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_confidence_set_rating(confidence, tmp);
                                break;
                        }




                        case IODEFV2_MSG_CONFIDENCE_EXT_RATING : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_confidence_set_ext_rating(confidence, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_confidence_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_system_impact_read:
 * @system_impact: Pointer to a #iodefv2_system_impact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_system_impact from the @msg message, and
 * store it into @system_impact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_system_impact_read(iodefv2_system_impact_t *system_impact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_SYSTEM_IMPACT_COMPLETION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_impact_set_completion(system_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_IMPACT_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_impact_set_type(system_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_IMPACT_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_impact_set_severity(system_impact, tmp);
                                break;
                        }




                        case IODEFV2_MSG_SYSTEM_IMPACT_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_impact_set_ext_type(system_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_IMPACT_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_impact_set_description(system_impact, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_system_impact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_software_reference_read:
 * @software_reference: Pointer to a #iodefv2_software_reference_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_software_reference from the @msg message, and
 * store it into @software_reference.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_software_reference_read(iodefv2_software_reference_t *software_reference, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_SOFTWARE_REFERENCE_DTYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_software_reference_set_dtype(software_reference, tmp);
                                break;
                        }




                        case IODEFV2_MSG_SOFTWARE_REFERENCE_EXT_SPEC_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_software_reference_set_ext_spec_name(software_reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SOFTWARE_REFERENCE_EXT_DTYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_software_reference_set_ext_dtype(software_reference, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_software_reference_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_business_impact_read:
 * @business_impact: Pointer to a #iodefv2_business_impact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_business_impact from the @msg message, and
 * store it into @business_impact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_business_impact_read(iodefv2_business_impact_t *business_impact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_BUSINESS_IMPACT_EXT_SEVERITY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_business_impact_set_ext_severity(business_impact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_BUSINESS_IMPACT_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_business_impact_set_type(business_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_BUSINESS_IMPACT_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_business_impact_set_severity(business_impact, tmp);
                                break;
                        }




                        case IODEFV2_MSG_BUSINESS_IMPACT_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_business_impact_set_ext_type(business_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_BUSINESS_IMPACT_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_business_impact_set_description(business_impact, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_business_impact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_indicator_reference_read:
 * @indicator_reference: Pointer to a #iodefv2_indicator_reference_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_indicator_reference from the @msg message, and
 * store it into @indicator_reference.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_reference_read(iodefv2_indicator_reference_t *indicator_reference, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_INDICATOR_REFERENCE_UID_REF : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_reference_set_uid_ref(indicator_reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INDICATOR_REFERENCE_VERSION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_reference_set_version(indicator_reference, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INDICATOR_REFERENCE_EUID_REF : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_reference_set_euid_ref(indicator_reference, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_indicator_reference_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_email_read:
 * @email: Pointer to a #iodefv2_email_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_email from the @msg message, and
 * store it into @email.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_email_read(iodefv2_email_t *email, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_EMAIL_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_set_type(email, tmp);
                                break;
                        }




                        case IODEFV2_MSG_EMAIL_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_set_ext_type(email, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EMAIL_EMAIL_TO : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_set_email_to(email, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EMAIL_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_set_description(email, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_email_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_intended_impact_read:
 * @intended_impact: Pointer to a #iodefv2_intended_impact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_intended_impact from the @msg message, and
 * store it into @intended_impact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_intended_impact_read(iodefv2_intended_impact_t *intended_impact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_INTENDED_IMPACT_EXT_SEVERITY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_intended_impact_set_ext_severity(intended_impact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INTENDED_IMPACT_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_intended_impact_set_type(intended_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INTENDED_IMPACT_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_intended_impact_set_severity(intended_impact, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INTENDED_IMPACT_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_intended_impact_set_ext_type(intended_impact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INTENDED_IMPACT_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_intended_impact_set_description(intended_impact, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_intended_impact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_additional_data_read:
 * @additional_data: Pointer to a #iodefv2_additional_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_additional_data from the @msg message, and
 * store it into @additional_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_additional_data_read(iodefv2_additional_data_t *additional_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDITIONAL_DATA_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_restriction(additional_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ADDITIONAL_DATA_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_name(additional_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_type(additional_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ADDITIONAL_DATA_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_ext_restriction(additional_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_FORMATID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_formatid(additional_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_observable_id(additional_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_MEANING : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_meaning(additional_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_EXT_DTYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_ext_dtype(additional_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_DATA : {
                                iodefv2_data_t *tmp = NULL;

                                ret = libiodefv2_extract_data_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_additional_data_set_data(additional_data, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_additional_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_counter_read:
 * @counter: Pointer to a #iodefv2_counter_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_counter from the @msg message, and
 * store it into @counter.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_counter_read(iodefv2_counter_t *counter, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_COUNTER_MEANING : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_meaning(counter, tmp);
                                break;
                        }


                        case IODEFV2_MSG_COUNTER_UNIT : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_unit(counter, tmp);
                                break;
                        }




                        case IODEFV2_MSG_COUNTER_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_ext_type(counter, tmp);
                                break;
                        }


                        case IODEFV2_MSG_COUNTER_DURATION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_duration(counter, tmp);
                                break;
                        }




                        case IODEFV2_MSG_COUNTER_EXT_UNIT : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_ext_unit(counter, tmp);
                                break;
                        }


                        case IODEFV2_MSG_COUNTER_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_type(counter, tmp);
                                break;
                        }




                        case IODEFV2_MSG_COUNTER_EXT_DURATION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_counter_set_ext_duration(counter, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_counter_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_monetary_impact_read:
 * @monetary_impact: Pointer to a #iodefv2_monetary_impact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_monetary_impact from the @msg message, and
 * store it into @monetary_impact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_monetary_impact_read(iodefv2_monetary_impact_t *monetary_impact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_MONETARY_IMPACT_CURRENCY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_monetary_impact_set_currency(monetary_impact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_MONETARY_IMPACT_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_monetary_impact_set_severity(monetary_impact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_monetary_impact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_service_name_read:
 * @service_name: Pointer to a #iodefv2_service_name_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_service_name from the @msg message, and
 * store it into @service_name.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_service_name_read(iodefv2_service_name_t *service_name, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_SERVICE_NAME_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_name_set_url(service_name, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_NAME_IANA_SERVICE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_name_set_iana_service(service_name, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_NAME_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_name_set_description(service_name, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_service_name_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_indicator_id_read:
 * @indicator_id: Pointer to a #iodefv2_indicator_id_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_indicator_id from the @msg message, and
 * store it into @indicator_id.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_id_read(iodefv2_indicator_id_t *indicator_id, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_INDICATOR_ID_VERSION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_id_set_version(indicator_id, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INDICATOR_ID_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_id_set_name(indicator_id, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_indicator_id_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_signature_data_read:
 * @signature_data: Pointer to a #iodefv2_signature_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_signature_data from the @msg message, and
 * store it into @signature_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_signature_data_read(iodefv2_signature_data_t *signature_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_SIGNATURE_DATA_SIGNATURE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_signature_data_set_signature(signature_data, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_signature_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_address_read:
 * @address: Pointer to a #iodefv2_address_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_address from the @msg message, and
 * store it into @address.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_address_read(iodefv2_address_t *address, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDRESS_CATEGORY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_address_set_category(address, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ADDRESS_VLAN_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_address_set_vlan_name(address, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDRESS_EXT_CATEGORY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_address_set_ext_category(address, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDRESS_VLAN_NUM : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_address_set_vlan_num(address, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDRESS_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_address_set_observable_id(address, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_address_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_application_header_read:
 * @application_header: Pointer to a #iodefv2_application_header_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_application_header from the @msg message, and
 * store it into @application_header.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_application_header_read(iodefv2_application_header_t *application_header, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_application_header_new_additional_data(application_header, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_application_header_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_certificate_data_read:
 * @certificate_data: Pointer to a #iodefv2_certificate_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_certificate_data from the @msg message, and
 * store it into @certificate_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_certificate_data_read(iodefv2_certificate_data_t *certificate_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_CERTIFICATE_DATA_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_data_set_restriction(certificate_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_CERTIFICATE_DATA_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_data_set_ext_restriction(certificate_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CERTIFICATE_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_certificate_data_set_observable_id(certificate_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_CERTIFICATE_TAG: {
                                int ret;
                                iodefv2_certificate_t *tmp = NULL;
                                ret = iodefv2_certificate_data_new_certificate(certificate_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_certificate_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_certificate_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_threat_actor_read:
 * @threat_actor: Pointer to a #iodefv2_threat_actor_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_threat_actor from the @msg message, and
 * store it into @threat_actor.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_threat_actor_read(iodefv2_threat_actor_t *threat_actor, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_THREAT_ACTOR_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_threat_actor_set_restriction(threat_actor, tmp);
                                break;
                        }




                        case IODEFV2_MSG_THREAT_ACTOR_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_threat_actor_set_ext_restriction(threat_actor, tmp);
                                break;
                        }



                        case IODEFV2_MSG_THREAT_ACTOR_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_threat_actor_set_url(threat_actor, tmp);
                                break;
                        }



                        case IODEFV2_MSG_THREAT_ACTOR_THREAT_ACTOR_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_threat_actor_set_threat_actor_id(threat_actor, tmp);
                                break;
                        }



                        case IODEFV2_MSG_THREAT_ACTOR_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_threat_actor_set_description(threat_actor, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_threat_actor_new_additional_data(threat_actor, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_threat_actor_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_method_read:
 * @method: Pointer to a #iodefv2_method_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_method from the @msg message, and
 * store it into @method.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_method_read(iodefv2_method_t *method, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_METHOD_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_method_set_restriction(method, tmp);
                                break;
                        }




                        case IODEFV2_MSG_METHOD_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_method_set_ext_restriction(method, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_method_new_additional_data(method, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_METHOD_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_method_set_description(method, tmp);
                                break;
                        }


                        case IODEFV2_MSG_REFERENCE_TAG: {
                                int ret;
                                iodefv2_reference_t *tmp = NULL;
                                ret = iodefv2_method_new_reference(method, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_method_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_alternative_id_read:
 * @alternative_id: Pointer to a #iodefv2_alternative_id_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_alternative_id from the @msg message, and
 * store it into @alternative_id.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_alternative_id_read(iodefv2_alternative_id_t *alternative_id, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ALTERNATIVE_ID_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_alternative_id_set_restriction(alternative_id, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ALTERNATIVE_ID_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_alternative_id_set_ext_restriction(alternative_id, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_ID_TAG: {
                                int ret;
                                iodefv2_incident_id_t *tmp = NULL;
                                ret = iodefv2_alternative_id_new_incident_id(alternative_id, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_incident_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_alternative_id_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_software_read:
 * @software: Pointer to a #iodefv2_software_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_software from the @msg message, and
 * store it into @software.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_software_read(iodefv2_software_t *software, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_SOFTWARE_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_software_set_url(software, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SOFTWARE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_software_set_description(software, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SOFTWARE_REFERENCE_TAG: {
                                int ret;
                                iodefv2_software_reference_t *tmp = NULL;
                                ret = iodefv2_software_new_software_reference(software, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_software_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_nameservers_read:
 * @nameservers: Pointer to a #iodefv2_nameservers_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_nameservers from the @msg message, and
 * store it into @nameservers.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_nameservers_read(iodefv2_nameservers_t *nameservers, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDRESS_TAG: {
                                int ret;
                                iodefv2_address_t *tmp = NULL;
                                ret = iodefv2_nameservers_new_address(nameservers, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_address_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_NAMESERVERS_SERVER : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_nameservers_set_server(nameservers, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_nameservers_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_windows_registry_keys_modified_read:
 * @windows_registry_keys_modified: Pointer to a #iodefv2_windows_registry_keys_modified_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_windows_registry_keys_modified from the @msg message, and
 * store it into @windows_registry_keys_modified.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_windows_registry_keys_modified_read(iodefv2_windows_registry_keys_modified_t *windows_registry_keys_modified, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_WINDOWS_REGISTRY_KEYS_MODIFIED_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_windows_registry_keys_modified_set_observable_id(windows_registry_keys_modified, tmp);
                                break;
                        }


                        case IODEFV2_MSG_KEY_TAG: {
                                int ret;
                                iodefv2_key_t *tmp = NULL;
                                ret = iodefv2_windows_registry_keys_modified_new_key(windows_registry_keys_modified, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_key_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_windows_registry_keys_modified_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_campaign_read:
 * @campaign: Pointer to a #iodefv2_campaign_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_campaign from the @msg message, and
 * store it into @campaign.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_campaign_read(iodefv2_campaign_t *campaign, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_CAMPAIGN_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_campaign_set_restriction(campaign, tmp);
                                break;
                        }




                        case IODEFV2_MSG_CAMPAIGN_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_campaign_set_ext_restriction(campaign, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CAMPAIGN_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_campaign_set_url(campaign, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_campaign_new_additional_data(campaign, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CAMPAIGN_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_campaign_set_description(campaign, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CAMPAIGN_CAMPAIGN_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_campaign_set_campaign_id(campaign, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_campaign_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_assessment_read:
 * @assessment: Pointer to a #iodefv2_assessment_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_assessment from the @msg message, and
 * store it into @assessment.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_assessment_read(iodefv2_assessment_t *assessment, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ASSESSMENT_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_restriction(assessment, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ASSESSMENT_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_ext_restriction(assessment, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ASSESSMENT_OCCURRENCE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_occurrence(assessment, tmp);
                                break;
                        }




                        case IODEFV2_MSG_ASSESSMENT_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_observable_id(assessment, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INTENDED_IMPACT_TAG: {
                                int ret;
                                iodefv2_intended_impact_t *tmp = NULL;
                                ret = iodefv2_assessment_new_intended_impact(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_intended_impact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONFIDENCE_TAG: {
                                int ret;
                                iodefv2_confidence_t *tmp = NULL;
                                ret = iodefv2_assessment_new_confidence(assessment, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_confidence_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_TIME_IMPACT_TAG: {
                                int ret;
                                iodefv2_time_impact_t *tmp = NULL;
                                ret = iodefv2_assessment_new_time_impact(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_time_impact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_assessment_new_additional_data(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_MONETARY_IMPACT_TAG: {
                                int ret;
                                iodefv2_monetary_impact_t *tmp = NULL;
                                ret = iodefv2_assessment_new_monetary_impact(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_monetary_impact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_COUNTER_TAG: {
                                int ret;
                                iodefv2_counter_t *tmp = NULL;
                                ret = iodefv2_assessment_new_counter(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_counter_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SYSTEM_IMPACT_TAG: {
                                int ret;
                                iodefv2_system_impact_t *tmp = NULL;
                                ret = iodefv2_assessment_new_system_impact(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_system_impact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_BUSINESS_IMPACT_TAG: {
                                int ret;
                                iodefv2_business_impact_t *tmp = NULL;
                                ret = iodefv2_assessment_new_business_impact(assessment, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_business_impact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ASSESSMENT_INCIDENT_CATEGORY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_incident_category(assessment, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ASSESSMENT_MITIGATING_FACTOR : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_mitigating_factor(assessment, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ASSESSMENT_CAUSE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_assessment_set_cause(assessment, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_assessment_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_attack_phase_read:
 * @attack_phase: Pointer to a #iodefv2_attack_phase_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_attack_phase from the @msg message, and
 * store it into @attack_phase.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_attack_phase_read(iodefv2_attack_phase_t *attack_phase, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_ATTACK_PHASE_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_attack_phase_set_url(attack_phase, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_attack_phase_new_additional_data(attack_phase, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ATTACK_PHASE_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_attack_phase_set_description(attack_phase, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ATTACK_PHASE_ATTACK_PHASE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_attack_phase_set_attack_phase_id(attack_phase, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_attack_phase_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_contact_read:
 * @contact: Pointer to a #iodefv2_contact_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_contact from the @msg message, and
 * store it into @contact.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_contact_read(iodefv2_contact_t *contact, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_CONTACT_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_restriction(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CONTACT_ROLE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_role(contact, tmp);
                                break;
                        }




                        case IODEFV2_MSG_CONTACT_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_ext_type(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CONTACT_EXT_ROLE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_ext_role(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CONTACT_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_ext_restriction(contact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_CONTACT_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_type(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_contact_new_additional_data(contact, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CONTACT_CONTACT_TITLE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_contact_title(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CONTACT_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_description(contact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_TELEPHONE_TAG: {
                                int ret;
                                iodefv2_telephone_t *tmp = NULL;
                                ret = iodefv2_contact_new_telephone(contact, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_telephone_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_EMAIL_TAG: {
                                int ret;
                                iodefv2_email_t *tmp = NULL;
                                ret = iodefv2_contact_new_email(contact, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_email_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CONTACT_CONTACT_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_contact_name(contact, tmp);
                                break;
                        }



                        case IODEFV2_MSG_CONTACT_TIMEZONE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_contact_set_timezone(contact, tmp);
                                break;
                        }


                        case IODEFV2_MSG_POSTAL_ADDRESS_TAG: {
                                int ret;
                                iodefv2_postal_address_t *tmp = NULL;
                                ret = iodefv2_contact_new_postal_address(contact, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_postal_address_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_REGISTRY_HANDLE_TAG: {
                                int ret;
                                iodefv2_registry_handle_t *tmp = NULL;
                                ret = iodefv2_contact_new_registry_handle(contact, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_registry_handle_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_contact_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_related_activity_read:
 * @related_activity: Pointer to a #iodefv2_related_activity_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_related_activity from the @msg message, and
 * store it into @related_activity.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_related_activity_read(iodefv2_related_activity_t *related_activity, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_RELATED_ACTIVITY_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_related_activity_set_restriction(related_activity, tmp);
                                break;
                        }




                        case IODEFV2_MSG_RELATED_ACTIVITY_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_related_activity_set_ext_restriction(related_activity, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_additional_data(related_activity, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONFIDENCE_TAG: {
                                int ret;
                                iodefv2_confidence_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_confidence(related_activity, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_confidence_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_RELATED_ACTIVITY_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_related_activity_set_description(related_activity, tmp);
                                break;
                        }


                        case IODEFV2_MSG_CAMPAIGN_TAG: {
                                int ret;
                                iodefv2_campaign_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_campaign(related_activity, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_campaign_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_RELATED_ACTIVITY_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_related_activity_set_url(related_activity, tmp);
                                break;
                        }


                        case IODEFV2_MSG_THREAT_ACTOR_TAG: {
                                int ret;
                                iodefv2_threat_actor_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_threat_actor(related_activity, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_threat_actor_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_INDICATOR_ID_TAG: {
                                int ret;
                                iodefv2_indicator_id_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_indicator_id(related_activity, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_INCIDENT_ID_TAG: {
                                int ret;
                                iodefv2_incident_id_t *tmp = NULL;
                                ret = iodefv2_related_activity_new_incident_id(related_activity, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_incident_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_related_activity_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_domain_contacts_read:
 * @domain_contacts: Pointer to a #iodefv2_domain_contacts_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_domain_contacts from the @msg message, and
 * store it into @domain_contacts.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_domain_contacts_read(iodefv2_domain_contacts_t *domain_contacts, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_domain_contacts_new_contact(domain_contacts, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_CONTACTS_SAME_DOMAIN_CONTACT : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_contacts_set_same_domain_contact(domain_contacts, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_domain_contacts_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_history_item_read:
 * @history_item: Pointer to a #iodefv2_history_item_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_history_item from the @msg message, and
 * store it into @history_item.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_history_item_read(iodefv2_history_item_t *history_item, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_HISTORY_ITEM_ACTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_action(history_item, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_restriction(history_item, tmp);
                                break;
                        }




                        case IODEFV2_MSG_HISTORY_ITEM_EXT_ACTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_ext_action(history_item, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_ext_restriction(history_item, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_observable_id(history_item, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_history_item_new_additional_data(history_item, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_history_item_new_contact(history_item, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_DEFINED_COA : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_defined_coa(history_item, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_description(history_item, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_ID_TAG: {
                                int ret;
                                iodefv2_incident_id_t *tmp = NULL;
                                ret = iodefv2_history_item_new_incident_id(history_item, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_incident_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_DATE_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_item_set_date_time(history_item, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_history_item_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_fuzzy_hash_read:
 * @fuzzy_hash: Pointer to a #iodefv2_fuzzy_hash_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_fuzzy_hash from the @msg message, and
 * store it into @fuzzy_hash.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_fuzzy_hash_read(iodefv2_fuzzy_hash_t *fuzzy_hash, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_fuzzy_hash_new_additional_data(fuzzy_hash, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_fuzzy_hash_new_software(fuzzy_hash, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_fuzzy_hash_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_hash_read:
 * @hash: Pointer to a #iodefv2_hash_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_hash from the @msg message, and
 * store it into @hash.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_hash_read(iodefv2_hash_t *hash, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_HASH_DIGEST_VALUE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_set_digest_value(hash, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HASH_DIGEST_METHOD : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_set_digest_method(hash, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HASH_CANONICALIZATION_METHOD : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_set_canonicalization_method(hash, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_hash_new_software(hash, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_hash_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_detection_pattern_read:
 * @detection_pattern: Pointer to a #iodefv2_detection_pattern_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_detection_pattern from the @msg message, and
 * store it into @detection_pattern.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_detection_pattern_read(iodefv2_detection_pattern_t *detection_pattern, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_DETECTION_PATTERN_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_detection_pattern_set_restriction(detection_pattern, tmp);
                                break;
                        }




                        case IODEFV2_MSG_DETECTION_PATTERN_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_detection_pattern_set_ext_restriction(detection_pattern, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DETECTION_PATTERN_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_detection_pattern_set_observable_id(detection_pattern, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DETECTION_PATTERN_DETECTION_CONFIGURATION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_detection_pattern_set_detection_configuration(detection_pattern, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DETECTION_PATTERN_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_detection_pattern_set_description(detection_pattern, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_detection_pattern_new_software(detection_pattern, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_detection_pattern_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_expectation_read:
 * @expectation: Pointer to a #iodefv2_expectation_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_expectation from the @msg message, and
 * store it into @expectation.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_expectation_read(iodefv2_expectation_t *expectation, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_EXPECTATION_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_restriction(expectation, tmp);
                                break;
                        }




                        case IODEFV2_MSG_EXPECTATION_EXT_ACTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_ext_action(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_EXT_SEVERITY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_ext_severity(expectation, tmp);
                                break;
                        }


                        case IODEFV2_MSG_EXPECTATION_SEVERITY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_severity(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_ACTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_action(expectation, tmp);
                                break;
                        }




                        case IODEFV2_MSG_EXPECTATION_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_ext_restriction(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_END_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_end_time(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_DEFINED_COA : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_defined_coa(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_description(expectation, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EXPECTATION_START_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_expectation_set_start_time(expectation, tmp);
                                break;
                        }


                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_expectation_new_contact(expectation, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_expectation_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_domain_data_read:
 * @domain_data: Pointer to a #iodefv2_domain_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_domain_data from the @msg message, and
 * store it into @domain_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_domain_data_read(iodefv2_domain_data_t *domain_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_DOMAIN_DATA_EXT_DOMAIN_STATUS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_ext_domain_status(domain_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_DOMAIN_STATUS : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_domain_status(domain_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_DOMAIN_DATA_EXT_SYSTEM_STATUS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_ext_system_status(domain_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DOMAIN_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_observable_id(domain_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_SYSTEM_STATUS : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_system_status(domain_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_domain_data_new_additional_data(domain_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_name(domain_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_NAMESERVERS_TAG: {
                                int ret;
                                iodefv2_nameservers_t *tmp = NULL;
                                ret = iodefv2_domain_data_new_nameservers(domain_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_nameservers_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_REGISTRATION_DATE : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_registration_date(domain_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_CONTACTS_TAG: {
                                int ret;
                                iodefv2_domain_contacts_t *tmp = NULL;
                                ret = iodefv2_domain_data_new_domain_contacts(domain_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_domain_contacts_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_DOMAIN_DATA_DATE_DOMAIN_WAS_CHECKED : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_date_domain_was_checked(domain_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DOMAIN_DATA_EXPIRATION_DATE : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_domain_data_set_expiration_date(domain_data, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_domain_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_hash_data_read:
 * @hash_data: Pointer to a #iodefv2_hash_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_hash_data from the @msg message, and
 * store it into @hash_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_hash_data_read(iodefv2_hash_data_t *hash_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_HASH_DATA_SCOPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_data_set_scope(hash_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_HASH_DATA_EXT_SCOPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_data_set_ext_scope(hash_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HASH_DATA_HASH_TARGET_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_hash_data_set_hash_target_id(hash_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_HASH_TAG: {
                                int ret;
                                iodefv2_hash_t *tmp = NULL;
                                ret = iodefv2_hash_data_new_hash(hash_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_hash_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_FUZZY_HASH_TAG: {
                                int ret;
                                iodefv2_fuzzy_hash_t *tmp = NULL;
                                ret = iodefv2_hash_data_new_fuzzy_hash(hash_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_fuzzy_hash_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_hash_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_bulk_observable_format_read:
 * @bulk_observable_format: Pointer to a #iodefv2_bulk_observable_format_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_bulk_observable_format from the @msg message, and
 * store it into @bulk_observable_format.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_bulk_observable_format_read(iodefv2_bulk_observable_format_t *bulk_observable_format, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_bulk_observable_format_new_additional_data(bulk_observable_format, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_HASH_TAG: {
                                int ret;
                                iodefv2_hash_t *tmp = NULL;
                                ret = iodefv2_bulk_observable_format_new_hash(bulk_observable_format, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_hash_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_bulk_observable_format_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_history_read:
 * @history: Pointer to a #iodefv2_history_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_history from the @msg message, and
 * store it into @history.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_history_read(iodefv2_history_t *history, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_HISTORY_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_history_set_restriction(history, tmp);
                                break;
                        }



                        case IODEFV2_MSG_HISTORY_ITEM_TAG: {
                                int ret;
                                iodefv2_history_item_t *tmp = NULL;
                                ret = iodefv2_history_new_history_item(history, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_history_item_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_history_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_discovery_read:
 * @discovery: Pointer to a #iodefv2_discovery_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_discovery from the @msg message, and
 * store it into @discovery.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_discovery_read(iodefv2_discovery_t *discovery, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_DISCOVERY_SOURCE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_source(discovery, tmp);
                                break;
                        }




                        case IODEFV2_MSG_DISCOVERY_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_ext_restriction(discovery, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DISCOVERY_EXT_SOURCE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_ext_source(discovery, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DISCOVERY_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_observable_id(discovery, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DISCOVERY_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_restriction(discovery, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DETECTION_PATTERN_TAG: {
                                int ret;
                                iodefv2_detection_pattern_t *tmp = NULL;
                                ret = iodefv2_discovery_new_detection_pattern(discovery, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_detection_pattern_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_discovery_new_contact(discovery, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_DISCOVERY_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_discovery_set_description(discovery, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_discovery_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_bulk_observable_read:
 * @bulk_observable: Pointer to a #iodefv2_bulk_observable_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_bulk_observable from the @msg message, and
 * store it into @bulk_observable.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_bulk_observable_read(iodefv2_bulk_observable_t *bulk_observable, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_BULK_OBSERVABLE_TYPE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_bulk_observable_set_type(bulk_observable, tmp);
                                break;
                        }




                        case IODEFV2_MSG_BULK_OBSERVABLE_EXT_TYPE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_bulk_observable_set_ext_type(bulk_observable, tmp);
                                break;
                        }



                        case IODEFV2_MSG_BULK_OBSERVABLE_BULK_OBSERVABLE_LIST : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_bulk_observable_set_bulk_observable_list(bulk_observable, tmp);
                                break;
                        }


                        case IODEFV2_MSG_BULK_OBSERVABLE_FORMAT_TAG: {
                                int ret;
                                iodefv2_bulk_observable_format_t *tmp = NULL;
                                ret = iodefv2_bulk_observable_new_bulk_observable_format(bulk_observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_bulk_observable_format_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_bulk_observable_new_additional_data(bulk_observable, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_bulk_observable_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_email_data_read:
 * @email_data: Pointer to a #iodefv2_email_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_email_data from the @msg message, and
 * store it into @email_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_email_data_read(iodefv2_email_data_t *email_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_EMAIL_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_observable_id(email_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_email_data_new_additional_data(email_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_HEADERS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_headers(email_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SIGNATURE_DATA_TAG: {
                                int ret;
                                iodefv2_signature_data_t *tmp = NULL;
                                ret = iodefv2_email_data_new_signature_data(email_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_signature_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_SUBJECT : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_subject(email_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_X_MAILER : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_x_mailer(email_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_HASH_DATA_TAG: {
                                int ret;
                                iodefv2_hash_data_t *tmp = NULL;
                                ret = iodefv2_email_data_new_hash_data(email_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_hash_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_FROM : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_from(email_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_APPLICATION_HEADER_TAG: {
                                int ret;
                                iodefv2_application_header_t *tmp = NULL;
                                ret = iodefv2_email_data_new_application_header(email_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_application_header_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_BODY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_body(email_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_MESSAGE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_message(email_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EMAIL_DATA_EMAIL_TO : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_email_data_set_email_to(email_data, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_email_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_file_read:
 * @file: Pointer to a #iodefv2_file_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_file from the @msg message, and
 * store it into @file.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_file_read(iodefv2_file_t *file, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_FILE_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_set_observable_id(file, tmp);
                                break;
                        }


                        case IODEFV2_MSG_HASH_DATA_TAG: {
                                int ret;
                                iodefv2_hash_data_t *tmp = NULL;
                                ret = iodefv2_file_new_hash_data(file, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_hash_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_file_new_additional_data(file, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SIGNATURE_DATA_TAG: {
                                int ret;
                                iodefv2_signature_data_t *tmp = NULL;
                                ret = iodefv2_file_new_signature_data(file, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_signature_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_FILE_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_set_url(file, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_file_new_software(file, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_FILE_FILE_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_set_file_name(file, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_file_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_node_read:
 * @node: Pointer to a #iodefv2_node_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_node from the @msg message, and
 * store it into @node.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_node_read(iodefv2_node_t *node, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_NODE_POSTAL_ADDRESS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_node_set_postal_address(node, tmp);
                                break;
                        }


                        case IODEFV2_MSG_COUNTER_TAG: {
                                int ret;
                                iodefv2_counter_t *tmp = NULL;
                                ret = iodefv2_node_new_counter(node, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_counter_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_NODE_LOCATION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_node_set_location(node, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_TAG: {
                                int ret;
                                iodefv2_domain_data_t *tmp = NULL;
                                ret = iodefv2_node_new_domain_data(node, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_domain_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_ADDRESS_TAG: {
                                int ret;
                                iodefv2_address_t *tmp = NULL;
                                ret = iodefv2_node_new_address(node, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_address_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_node_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_service_read:
 * @service: Pointer to a #iodefv2_service_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_service from the @msg message, and
 * store it into @service.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_service_read(iodefv2_service_t *service, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {



                        case IODEFV2_MSG_SERVICE_IP_PROTOCOL : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_ip_protocol(service, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_observable_id(service, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_PROTO_CODE : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_proto_code(service, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_PORTLIST : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_portlist(service, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_PROTO_FIELD : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_proto_field(service, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SERVICE_NAME_TAG: {
                                int ret;
                                iodefv2_service_name_t *tmp = NULL;
                                ret = iodefv2_service_new_service_name(service, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_service_name_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_APPLICATION_HEADER_TAG: {
                                int ret;
                                iodefv2_application_header_t *tmp = NULL;
                                ret = iodefv2_service_new_application_header(service, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_application_header_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EMAIL_DATA_TAG: {
                                int ret;
                                iodefv2_email_data_t *tmp = NULL;
                                ret = iodefv2_service_new_email_data(service, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_email_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_SERVICE_PROTO_TYPE : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_proto_type(service, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SERVICE_PORT : {
                                uint32_t tmp = 0;

                                ret = libiodefv2_extract_uint32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_service_set_port(service, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_service_new_software(service, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_service_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_file_data_read:
 * @file_data: Pointer to a #iodefv2_file_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_file_data from the @msg message, and
 * store it into @file_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_file_data_read(iodefv2_file_data_t *file_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_FILE_DATA_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_data_set_restriction(file_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_FILE_DATA_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_data_set_ext_restriction(file_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_FILE_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_file_data_set_observable_id(file_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_FILE_TAG: {
                                int ret;
                                iodefv2_file_t *tmp = NULL;
                                ret = iodefv2_file_data_new_file(file_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_file_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_file_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_system_read:
 * @system: Pointer to a #iodefv2_system_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_system from the @msg message, and
 * store it into @system.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_system_read(iodefv2_system_t *system, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_SYSTEM_CATEGORY : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_category(system, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_restriction(system, tmp);
                                break;
                        }




                        case IODEFV2_MSG_SYSTEM_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_ext_restriction(system, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_EXT_OWNERSHIP : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_ext_ownership(system, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_EXT_CATEGORY : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_ext_category(system, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SYSTEM_SPOOFED : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_spoofed(system, tmp);
                                break;
                        }



                        case IODEFV2_MSG_SYSTEM_VIRTUAL : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_virtual(system, tmp);
                                break;
                        }




                        case IODEFV2_MSG_SYSTEM_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_observable_id(system, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SYSTEM_OWNERSHIP : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_ownership(system, tmp);
                                break;
                        }




                        case IODEFV2_MSG_SYSTEM_INTERFACE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_interface(system, tmp);
                                break;
                        }


                        case IODEFV2_MSG_NODE_TAG: {
                                int ret;
                                iodefv2_node_t *tmp = NULL;
                                ret = iodefv2_system_new_node(system, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_node_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_system_new_additional_data(system, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_SYSTEM_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_description(system, tmp);
                                break;
                        }


                        case IODEFV2_MSG_SERVICE_TAG: {
                                int ret;
                                iodefv2_service_t *tmp = NULL;
                                ret = iodefv2_system_new_service(system, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_service_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_SYSTEM_ASSET_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_system_set_asset_id(system, tmp);
                                break;
                        }


                        case IODEFV2_MSG_COUNTER_TAG: {
                                int ret;
                                iodefv2_counter_t *tmp = NULL;
                                ret = iodefv2_system_new_counter(system, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_counter_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_NODE_ROLE_TAG: {
                                int ret;
                                iodefv2_node_role_t *tmp = NULL;
                                ret = iodefv2_system_new_node_role(system, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_node_role_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_system_new_software(system, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_system_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_record_data_read:
 * @record_data: Pointer to a #iodefv2_record_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_record_data from the @msg message, and
 * store it into @record_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_data_read(iodefv2_record_data_t *record_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_RECORD_DATA_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_restriction(record_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_RECORD_DATA_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_ext_restriction(record_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_RECORD_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_observable_id(record_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_record_data_new_additional_data(record_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_RECORD_DATA_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_description(record_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_RECORD_DATA_URL : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_url(record_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_CERTIFICATE_DATA_TAG: {
                                int ret;
                                iodefv2_certificate_data_t *tmp = NULL;
                                ret = iodefv2_record_data_new_certificate_data(record_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_certificate_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_RECORD_PATTERN_TAG: {
                                int ret;
                                iodefv2_record_pattern_t *tmp = NULL;
                                ret = iodefv2_record_data_new_record_pattern(record_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_record_pattern_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_RECORD_DATA_DATE_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_data_set_date_time(record_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_WINDOWS_REGISTRY_KEYS_MODIFIED_TAG: {
                                int ret;
                                iodefv2_windows_registry_keys_modified_t *tmp = NULL;
                                ret = iodefv2_record_data_new_windows_registry_keys_modified(record_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_windows_registry_keys_modified_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_FILE_DATA_TAG: {
                                int ret;
                                iodefv2_file_data_t *tmp = NULL;
                                ret = iodefv2_record_data_new_file_data(record_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_file_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SOFTWARE_TAG: {
                                int ret;
                                iodefv2_software_t *tmp = NULL;
                                ret = iodefv2_record_data_new_software(record_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_software_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_record_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_record_read:
 * @record: Pointer to a #iodefv2_record_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_record from the @msg message, and
 * store it into @record.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_read(iodefv2_record_t *record, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_RECORD_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_set_restriction(record, tmp);
                                break;
                        }




                        case IODEFV2_MSG_RECORD_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_record_set_ext_restriction(record, tmp);
                                break;
                        }


                        case IODEFV2_MSG_RECORD_DATA_TAG: {
                                int ret;
                                iodefv2_record_data_t *tmp = NULL;
                                ret = iodefv2_record_new_record_data(record, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_record_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_record_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_flow_read:
 * @flow: Pointer to a #iodefv2_flow_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_flow from the @msg message, and
 * store it into @flow.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_flow_read(iodefv2_flow_t *flow, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_SYSTEM_TAG: {
                                int ret;
                                iodefv2_system_t *tmp = NULL;
                                ret = iodefv2_flow_new_system(flow, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_system_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_flow_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_event_data_read:
 * @event_data: Pointer to a #iodefv2_event_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_event_data from the @msg message, and
 * store it into @event_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_event_data_read(iodefv2_event_data_t *event_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_EVENT_DATA_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_restriction(event_data, tmp);
                                break;
                        }




                        case IODEFV2_MSG_EVENT_DATA_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_ext_restriction(event_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EVENT_DATA_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_observable_id(event_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EVENT_DATA_DETECT_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_detect_time(event_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_event_data_new_additional_data(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EVENT_DATA_REPORT_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_report_time(event_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EVENT_DATA_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_description(event_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_FLOW_TAG: {
                                int ret;
                                iodefv2_flow_t *tmp = NULL;
                                ret = iodefv2_event_data_new_flow(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_flow_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_EXPECTATION_TAG: {
                                int ret;
                                iodefv2_expectation_t *tmp = NULL;
                                ret = iodefv2_event_data_new_expectation(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_expectation_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_RECORD_TAG: {
                                int ret;
                                iodefv2_record_t *tmp = NULL;
                                ret = iodefv2_event_data_new_record(event_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_record_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_event_data_new_contact(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EVENT_DATA_START_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_start_time(event_data, tmp);
                                break;
                        }



                        case IODEFV2_MSG_EVENT_DATA_END_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_end_time(event_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ASSESSMENT_TAG: {
                                int ret;
                                iodefv2_assessment_t *tmp = NULL;
                                ret = iodefv2_event_data_new_assessment(event_data, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_assessment_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_METHOD_TAG: {
                                int ret;
                                iodefv2_method_t *tmp = NULL;
                                ret = iodefv2_event_data_new_method(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_method_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EVENT_DATA_RECOVERY_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_event_data_set_recovery_time(event_data, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DISCOVERY_TAG: {
                                int ret;
                                iodefv2_discovery_t *tmp = NULL;
                                ret = iodefv2_event_data_new_discovery(event_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_discovery_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_event_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_observable_read:
 * @observable: Pointer to a #iodefv2_observable_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_observable from the @msg message, and
 * store it into @observable.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_observable_read(iodefv2_observable_t *observable, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_OBSERVABLE_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_observable_set_restriction(observable, tmp);
                                break;
                        }




                        case IODEFV2_MSG_OBSERVABLE_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_observable_set_ext_restriction(observable, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DETECTION_PATTERN_TAG: {
                                int ret;
                                iodefv2_detection_pattern_t *tmp = NULL;
                                ret = iodefv2_observable_new_detection_pattern(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_detection_pattern_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_SERVICE_TAG: {
                                int ret;
                                iodefv2_service_t *tmp = NULL;
                                ret = iodefv2_observable_new_service(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_service_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_additional_data(observable, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_SYSTEM_TAG: {
                                int ret;
                                iodefv2_system_t *tmp = NULL;
                                ret = iodefv2_observable_new_system(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_system_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_DOMAIN_DATA_TAG: {
                                int ret;
                                iodefv2_domain_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_domain_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_domain_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EMAIL_DATA_TAG: {
                                int ret;
                                iodefv2_email_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_email_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_email_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ASSESSMENT_TAG: {
                                int ret;
                                iodefv2_assessment_t *tmp = NULL;
                                ret = iodefv2_observable_new_assessment(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_assessment_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_RECORD_DATA_TAG: {
                                int ret;
                                iodefv2_record_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_record_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_record_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_REFERENCE_TAG: {
                                int ret;
                                iodefv2_reference_t *tmp = NULL;
                                ret = iodefv2_observable_new_reference(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_HISTORY_ITEM_TAG: {
                                int ret;
                                iodefv2_history_item_t *tmp = NULL;
                                ret = iodefv2_observable_new_history_item(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_history_item_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_BULK_OBSERVABLE_TAG: {
                                int ret;
                                iodefv2_bulk_observable_t *tmp = NULL;
                                ret = iodefv2_observable_new_bulk_observable(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_bulk_observable_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CERTIFICATE_DATA_TAG: {
                                int ret;
                                iodefv2_certificate_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_certificate_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_certificate_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EXPECTATION_TAG: {
                                int ret;
                                iodefv2_expectation_t *tmp = NULL;
                                ret = iodefv2_observable_new_expectation(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_expectation_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_WINDOWS_REGISTRY_KEYS_MODIFIED_TAG: {
                                int ret;
                                iodefv2_windows_registry_keys_modified_t *tmp = NULL;
                                ret = iodefv2_observable_new_windows_registry_keys_modified(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_windows_registry_keys_modified_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDRESS_TAG: {
                                int ret;
                                iodefv2_address_t *tmp = NULL;
                                ret = iodefv2_observable_new_address(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_address_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EVENT_DATA_TAG: {
                                int ret;
                                iodefv2_event_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_event_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_event_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_FILE_DATA_TAG: {
                                int ret;
                                iodefv2_file_data_t *tmp = NULL;
                                ret = iodefv2_observable_new_file_data(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_file_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_REGISTRY_HANDLE_TAG: {
                                int ret;
                                iodefv2_registry_handle_t *tmp = NULL;
                                ret = iodefv2_observable_new_registry_handle(observable, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_registry_handle_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_observable_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_indicator_expression_read:
 * @indicator_expression: Pointer to a #iodefv2_indicator_expression_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_indicator_expression from the @msg message, and
 * store it into @indicator_expression.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_expression_read(iodefv2_indicator_expression_t *indicator_expression, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_INDICATOR_EXPRESSION_OPERATOR : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_expression_set_operator(indicator_expression, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INDICATOR_EXPRESSION_EXT_OPERATOR : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_expression_set_ext_operator(indicator_expression, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_REFERENCE_TAG: {
                                int ret;
                                iodefv2_indicator_reference_t *tmp = NULL;
                                ret = iodefv2_indicator_expression_new_indicator_reference(indicator_expression, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_OBSERVABLE_TAG: {
                                int ret;
                                iodefv2_observable_t *tmp = NULL;
                                ret = iodefv2_indicator_expression_new_observable(indicator_expression, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_observable_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONFIDENCE_TAG: {
                                int ret;
                                iodefv2_confidence_t *tmp = NULL;
                                ret = iodefv2_indicator_expression_new_confidence(indicator_expression, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_confidence_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_EXPRESSION_TAG: {
                                int ret;
                                iodefv2_indicator_expression_t *tmp = NULL;
                                ret = iodefv2_indicator_expression_new_indicator_expression(indicator_expression, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_expression_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_indicator_expression_new_additional_data(indicator_expression, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_indicator_expression_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_indicator_read:
 * @indicator: Pointer to a #iodefv2_indicator_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_indicator from the @msg message, and
 * store it into @indicator.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_read(iodefv2_indicator_t *indicator, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_INDICATOR_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_set_restriction(indicator, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INDICATOR_EXT_RESTRICTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_set_ext_restriction(indicator, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_TAG: {
                                int ret;
                                iodefv2_alternative_indicator_id_t *tmp = NULL;
                                ret = iodefv2_indicator_new_alternative_indicator_id(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_alternative_indicator_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_CONFIDENCE_TAG: {
                                int ret;
                                iodefv2_confidence_t *tmp = NULL;
                                ret = iodefv2_indicator_new_confidence(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_confidence_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_REFERENCE_TAG: {
                                int ret;
                                iodefv2_reference_t *tmp = NULL;
                                ret = iodefv2_indicator_new_reference(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_OBSERVABLE_TAG: {
                                int ret;
                                iodefv2_observable_t *tmp = NULL;
                                ret = iodefv2_indicator_new_observable(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_observable_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_indicator_new_additional_data(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_INDICATOR_EXPRESSION_TAG: {
                                int ret;
                                iodefv2_indicator_expression_t *tmp = NULL;
                                ret = iodefv2_indicator_new_indicator_expression(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_expression_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_indicator_new_contact(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_NODE_ROLE_TAG: {
                                int ret;
                                iodefv2_node_role_t *tmp = NULL;
                                ret = iodefv2_indicator_new_node_role(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_node_role_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_START_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_set_start_time(indicator, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_ID_TAG: {
                                int ret;
                                iodefv2_indicator_id_t *tmp = NULL;
                                ret = iodefv2_indicator_new_indicator_id(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_REFERENCE_TAG: {
                                int ret;
                                iodefv2_indicator_reference_t *tmp = NULL;
                                ret = iodefv2_indicator_new_indicator_reference(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_OBSERVABLE_REFERENCE_TAG: {
                                int ret;
                                iodefv2_observable_reference_t *tmp = NULL;
                                ret = iodefv2_indicator_new_observable_reference(indicator, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_observable_reference_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_ATTACK_PHASE_TAG: {
                                int ret;
                                iodefv2_attack_phase_t *tmp = NULL;
                                ret = iodefv2_indicator_new_attack_phase(indicator, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_attack_phase_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_END_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_indicator_set_end_time(indicator, tmp);
                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_indicator_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_indicator_data_read:
 * @indicator_data: Pointer to a #iodefv2_indicator_data_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_indicator_data from the @msg message, and
 * store it into @indicator_data.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_data_read(iodefv2_indicator_data_t *indicator_data, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_INDICATOR_TAG: {
                                int ret;
                                iodefv2_indicator_t *tmp = NULL;
                                ret = iodefv2_indicator_data_new_indicator(indicator_data, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_indicator_data_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_incident_read:
 * @incident: Pointer to a #iodefv2_incident_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_incident from the @msg message, and
 * store it into @incident.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_incident_read(iodefv2_incident_t *incident, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_INCIDENT_STATUS : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_status(incident, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_LANG : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_lang(incident, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INCIDENT_EXT_PURPOSE : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_ext_purpose(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_PURPOSE : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_purpose(incident, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INCIDENT_EXT_STATUS : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_ext_status(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_RESTRICTION : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_restriction(incident, tmp);
                                break;
                        }




                        case IODEFV2_MSG_INCIDENT_OBSERVABLE_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_observable_id(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_incident_new_additional_data(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_HISTORY_TAG: {
                                int ret;
                                iodefv2_history_t *tmp = NULL;
                                ret = iodefv2_incident_new_history(incident, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_history_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_START_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_start_time(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ALTERNATIVE_ID_TAG: {
                                int ret;
                                iodefv2_alternative_id_t *tmp = NULL;
                                ret = iodefv2_incident_new_alternative_id(incident, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_alternative_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_CONTACT_TAG: {
                                int ret;
                                iodefv2_contact_t *tmp = NULL;
                                ret = iodefv2_incident_new_contact(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_contact_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_RELATED_ACTIVITY_TAG: {
                                int ret;
                                iodefv2_related_activity_t *tmp = NULL;
                                ret = iodefv2_incident_new_related_activity(incident, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_related_activity_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_END_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_end_time(incident, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_GENERATION_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_generation_time(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ASSESSMENT_TAG: {
                                int ret;
                                iodefv2_assessment_t *tmp = NULL;
                                ret = iodefv2_incident_new_assessment(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_assessment_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_METHOD_TAG: {
                                int ret;
                                iodefv2_method_t *tmp = NULL;
                                ret = iodefv2_incident_new_method(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_method_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_RECOVERY_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_recovery_time(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_DISCOVERY_TAG: {
                                int ret;
                                iodefv2_discovery_t *tmp = NULL;
                                ret = iodefv2_incident_new_discovery(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_discovery_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_INCIDENT_DETECT_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_detect_time(incident, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_REPORT_TIME : {
                                iodefv2_time_t *tmp = NULL;

                                ret = libiodefv2_extract_time_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_report_time(incident, tmp);
                                break;
                        }



                        case IODEFV2_MSG_INCIDENT_DESCRIPTION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_incident_set_description(incident, tmp);
                                break;
                        }


                        case IODEFV2_MSG_INDICATOR_DATA_TAG: {
                                int ret;
                                iodefv2_indicator_data_t *tmp = NULL;
                                ret = iodefv2_incident_new_indicator_data(incident, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_indicator_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }


                        case IODEFV2_MSG_EVENT_DATA_TAG: {
                                int ret;
                                iodefv2_event_data_t *tmp = NULL;
                                ret = iodefv2_incident_new_event_data(incident, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_event_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_INCIDENT_ID_TAG: {
                                int ret;
                                iodefv2_incident_id_t *tmp = NULL;
                                ret = iodefv2_incident_new_incident_id(incident, &tmp);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_incident_id_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_incident_t: '%u'", tag);
                }

        }

        return 0;
}
/**
 * iodefv2_document_read:
 * @document: Pointer to a #iodefv2_document_t object.
 * @msg: Pointer to a #libiodefv2_msg_t object, containing a message.
 *
 * Read an iodefv2_document from the @msg message, and
 * store it into @document.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_document_read(iodefv2_document_t *document, libiodefv2_msg_t *msg)
{
        int ret;
        void *buf;
        uint8_t tag;
        uint32_t len;

        while ( 1 ) {
                ret = libiodefv2_msg_get(msg, &tag, &len, &buf);
                if ( ret < 0 )
                        return ret;

                switch ( tag ) {


                        case IODEFV2_MSG_DOCUMENT_LANG : {
                                int32_t tmp = 0;

                                ret = libiodefv2_extract_int32_safe(&tmp, buf, len);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_document_set_lang(document, tmp);
                                break;
                        }




                        case IODEFV2_MSG_DOCUMENT_FORMATID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_document_set_formatid(document, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DOCUMENT_VERSION : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_document_set_version(document, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DOCUMENT_PRIVATE_ENUM_NAME : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_document_set_private_enum_name(document, tmp);
                                break;
                        }



                        case IODEFV2_MSG_DOCUMENT_PRIVATE_ENUM_ID : {
                                libiodefv2_string_t *tmp = NULL;

                                ret = libiodefv2_extract_string_safe(&tmp, buf, len, msg);
                                if ( ret < 0 )
                                        return ret;
                                iodefv2_document_set_private_enum_id(document, tmp);
                                break;
                        }


                        case IODEFV2_MSG_ADDITIONAL_DATA_TAG: {
                                int ret;
                                iodefv2_additional_data_t *tmp = NULL;
                                ret = iodefv2_document_new_additional_data(document, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_additional_data_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }

                        case IODEFV2_MSG_INCIDENT_TAG: {
                                int ret;
                                iodefv2_incident_t *tmp = NULL;
                                ret = iodefv2_document_new_incident(document, &tmp, -1);
                                if ( ret < 0 )
                                        return ret;


                                ret = iodefv2_incident_read(tmp, msg);
                                if ( ret < 0 )
                                        return ret;

                                break;
                        }
                        case IODEFV2_MSG_END_OF_TAG:
                                return 0;

                        default:
                                return libiodefv2_error_verbose(LIBIODEFV2_ERROR_IODEFV2_UNKNOWN_TAG, "Unknown tag while readingiodefv2_document_t: '%u'", tag);
                }

        }

        return 0;
}

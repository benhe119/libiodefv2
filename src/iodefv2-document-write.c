
/*****
*
* Copyright (C) 2001-2016 CS-SI. All Rights Reserved.
* Author: Yoann Vandoorselaere <yoann.v@prelude-ids.com>
* Author: Nicolas Delon <nicolas.delon@prelude-ids.com>
*
* This file is part of the Libiodefv2 library.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2, or (at your option)
* any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License along
* with this program; if not, write to the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
*****/

/*
 * This file was automatically generated by our generator, version 1
 *
 * Do not make changes to this file unless you know what you are doing.
 * modify the template interface file instead.
 * IODEFV2 version : RFC5070-bis-26
 * Template file: generate-top-level-class-write.c.mako
 *
 */

#include "config.h"

#include <stdio.h>
#include <string.h>
#include <unistd.h>

#include "libiodefv2-inttypes.h"
#include "libiodefv2-list.h"
#include "libiodefv2-log.h"
#include "libiodefv2-io.h"
#include "libiodefv2-ident.h"
#include "libiodefv2-document-id.h"
#include "iodefv2-document-id.h"
#include "iodefv2.h"
#include "iodefv2-tree-wrap.h"
#include "iodefv2-document-write.h"
#include "common.h"



/*
 * If you wonder why we do this, and why life is complicated,
 * then wonder why the hell the guys that wrote IODEFV2 choose to use XML.
 * XML is dog slow. And XML'll never achieve performance needed for real time IDS.
 *
 * Here we are trying to communicate using a home made, binary version of IODEFV2.
 */
int binary_write(libiodefv2_io_t*, uint8_t, uint32_t, const void*);
int binary_write(libiodefv2_io_t *fd, uint8_t tag, uint32_t len, const void *data)
{
        uint32_t l;

        l = htonl(len);

        libiodefv2_io_write(fd, &tag, sizeof(tag));
        libiodefv2_io_write(fd, &l, sizeof(l));

        if ( len > 0 )
                libiodefv2_io_write(fd, data, len);

        return 1;
}



static inline int libiodefv2_string_write(libiodefv2_string_t *string, libiodefv2_io_t *fd, uint8_t tag)
{
        if ( ! string || libiodefv2_string_is_empty(string) )
                return 0;

        return binary_write(fd, tag, libiodefv2_string_get_len(string) + 1, libiodefv2_string_get_string(string));
}



static inline int uint64_write(uint64_t data, libiodefv2_io_t *fd, uint8_t tag)
{
        uint64_t dst;

        dst = libiodefv2_hton64(data);

        return binary_write(fd, tag, sizeof(dst), &dst);
}



static inline int uint32_write(uint32_t data, libiodefv2_io_t *fd, uint8_t tag)
{
        data = htonl(data);
        return binary_write(fd, tag, sizeof(data), &data);
}



static inline int int32_write(uint32_t data, libiodefv2_io_t *fd, uint8_t tag)
{
        return uint32_write(data, fd, tag);
}



static inline int uint8_write(uint8_t data, libiodefv2_io_t *fd, uint8_t tag)
{
        return binary_write(fd, tag, sizeof(data), &data);
}



static inline int uint16_write(uint16_t data, libiodefv2_io_t *fd, uint8_t tag)
{
        data = htons(data);
        return binary_write(fd, tag, sizeof(data), &data);
}



static inline int float_write(float data, libiodefv2_io_t *fd, uint8_t tag)
{
        uint32_t tmp = libiodefv2_htonf(data);
        return binary_write(fd, tag, sizeof(tmp), &tmp);
}


static inline int iodefv2_time_write(const iodefv2_time_t *data, libiodefv2_io_t *fd, uint8_t tag)
{
        uint32_t tmp;
        unsigned char buf[12];

        if ( ! data )
                return 0;

        tmp = htonl(iodefv2_time_get_sec(data));
        memcpy(buf, &tmp, sizeof(tmp));

        tmp = htonl(iodefv2_time_get_usec(data));
        memcpy(buf + 4, &tmp, sizeof(tmp));

        tmp = htonl(iodefv2_time_get_gmt_offset(data));
        memcpy(buf + 8, &tmp, sizeof(tmp));

        return binary_write(fd, tag, sizeof (buf), buf);
}



static inline int iodefv2_data_write(iodefv2_data_t *data, libiodefv2_io_t *fd, uint8_t tag)
{
        int ret;
        iodefv2_data_type_t type;

        if ( ! data )
                return 0;

        type = iodefv2_data_get_type(data);
        if ( type == IODEFV2_DATA_TYPE_UNKNOWN )
                return 0;

        ret = uint32_write(iodefv2_data_get_type(data), fd, tag);
        if ( ret < 0 )
                return ret;

        switch ( type ) {
        case IODEFV2_DATA_TYPE_CHAR:
        case IODEFV2_DATA_TYPE_BYTE:
                ret = uint8_write(* (const uint8_t *) iodefv2_data_get_data(data), fd, tag);
                break;

        case IODEFV2_DATA_TYPE_UINT32:
                ret = uint32_write(iodefv2_data_get_int(data), fd, tag);
                break;

        case IODEFV2_DATA_TYPE_INT:
                ret = uint64_write(iodefv2_data_get_int(data), fd, tag);
                break;

        case IODEFV2_DATA_TYPE_FLOAT:
                ret = float_write(iodefv2_data_get_float(data), fd, tag);
                break;

        case IODEFV2_DATA_TYPE_CHAR_STRING:
        case IODEFV2_DATA_TYPE_BYTE_STRING:
                ret = binary_write(fd, tag, iodefv2_data_get_len(data), iodefv2_data_get_data(data));
                break;

        case IODEFV2_DATA_TYPE_TIME:
                ret = iodefv2_time_write(iodefv2_data_get_data(data), fd, tag);
                break;

        case IODEFV2_DATA_TYPE_UNKNOWN:
                /* nop */;
        }

        return ret;
}

/**
 * iodefv2_telephone_write:
 * @telephone: Pointer to a #iodefv2_telephone_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @telephone within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_telephone_write(iodefv2_telephone_t *telephone, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! telephone )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_TELEPHONE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_telephone_type_t *tmp;

                tmp = iodefv2_telephone_get_type(telephone);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_TELEPHONE_TYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_telephone_get_ext_type(telephone), fd, IODEFV2_MSG_TELEPHONE_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_telephone_get_telephone_number(telephone), fd, IODEFV2_MSG_TELEPHONE_TELEPHONE_NUMBER);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_telephone_get_description(telephone), fd, IODEFV2_MSG_TELEPHONE_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_certificate_write:
 * @certificate: Pointer to a #iodefv2_certificate_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @certificate within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_certificate_write(iodefv2_certificate_t *certificate, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! certificate )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_CERTIFICATE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_certificate_get_observable_id(certificate), fd, IODEFV2_MSG_CERTIFICATE_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_data_write(iodefv2_certificate_get_x509_data(certificate), fd, IODEFV2_MSG_CERTIFICATE_X509_DATA);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_certificate_get_description(certificate), fd, IODEFV2_MSG_CERTIFICATE_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_key_write:
 * @key: Pointer to a #iodefv2_key_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @key within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_key_write(iodefv2_key_t *key, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! key )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_KEY_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_key_registryaction_t *tmp;

                tmp = iodefv2_key_get_registryaction(key);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_KEY_REGISTRYACTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_key_get_ext_registryaction(key), fd, IODEFV2_MSG_KEY_EXT_REGISTRYACTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_key_get_observable_id(key), fd, IODEFV2_MSG_KEY_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_key_get_key_name(key), fd, IODEFV2_MSG_KEY_KEY_NAME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_key_get_key_value(key), fd, IODEFV2_MSG_KEY_KEY_VALUE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_observable_reference_write:
 * @observable_reference: Pointer to a #iodefv2_observable_reference_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @observable_reference within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_observable_reference_write(iodefv2_observable_reference_t *observable_reference, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! observable_reference )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_OBSERVABLE_REFERENCE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_observable_reference_get_uid_ref(observable_reference), fd, IODEFV2_MSG_OBSERVABLE_REFERENCE_UID_REF);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_registry_handle_write:
 * @registry_handle: Pointer to a #iodefv2_registry_handle_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @registry_handle within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_registry_handle_write(iodefv2_registry_handle_t *registry_handle, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! registry_handle )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_REGISTRY_HANDLE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_registry_handle_get_registry(registry_handle), fd, IODEFV2_MSG_REGISTRY_HANDLE_REGISTRY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_registry_handle_get_ext_registry(registry_handle), fd, IODEFV2_MSG_REGISTRY_HANDLE_EXT_REGISTRY);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}




/**
 * iodefv2_time_impact_write:
 * @time_impact: Pointer to a #iodefv2_time_impact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @time_impact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_time_impact_write(iodefv2_time_impact_t *time_impact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! time_impact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_TIME_IMPACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_time_impact_get_ext_metric(time_impact), fd, IODEFV2_MSG_TIME_IMPACT_EXT_METRIC);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_time_impact_get_duration(time_impact), fd, IODEFV2_MSG_TIME_IMPACT_DURATION);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_time_impact_get_metric(time_impact), fd, IODEFV2_MSG_TIME_IMPACT_METRIC);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_time_impact_severity_t *tmp;

                tmp = iodefv2_time_impact_get_severity(time_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_TIME_IMPACT_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_time_impact_get_ext_duration(time_impact), fd, IODEFV2_MSG_TIME_IMPACT_EXT_DURATION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_record_pattern_write:
 * @record_pattern: Pointer to a #iodefv2_record_pattern_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @record_pattern within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_pattern_write(iodefv2_record_pattern_t *record_pattern, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! record_pattern )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_RECORD_PATTERN_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                uint32_t *tmp;

                tmp = iodefv2_record_pattern_get_instance(record_pattern);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RECORD_PATTERN_INSTANCE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_record_pattern_get_ext_type(record_pattern), fd, IODEFV2_MSG_RECORD_PATTERN_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        {
                uint32_t *tmp;

                tmp = iodefv2_record_pattern_get_offset(record_pattern);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RECORD_PATTERN_OFFSET);
                        if ( ret < 0 )
                                return ret;
                }
        }


        {
                iodefv2_record_pattern_offsetunit_t *tmp;

                tmp = iodefv2_record_pattern_get_offsetunit(record_pattern);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RECORD_PATTERN_OFFSETUNIT);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_record_pattern_get_ext_offsetunit(record_pattern), fd, IODEFV2_MSG_RECORD_PATTERN_EXT_OFFSETUNIT);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_record_pattern_get_type(record_pattern), fd, IODEFV2_MSG_RECORD_PATTERN_TYPE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_reference_write:
 * @reference: Pointer to a #iodefv2_reference_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @reference within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_reference_write(iodefv2_reference_t *reference, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! reference )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_REFERENCE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_reference_get_observable_id(reference), fd, IODEFV2_MSG_REFERENCE_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_reference_get_url(reference), fd, IODEFV2_MSG_REFERENCE_URL);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_reference_get_description(reference), fd, IODEFV2_MSG_REFERENCE_DESCRIPTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_reference_get_reference_name(reference), fd, IODEFV2_MSG_REFERENCE_REFERENCE_NAME);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_postal_address_write:
 * @postal_address: Pointer to a #iodefv2_postal_address_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @postal_address within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_postal_address_write(iodefv2_postal_address_t *postal_address, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! postal_address )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_POSTAL_ADDRESS_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_postal_address_type_t *tmp;

                tmp = iodefv2_postal_address_get_type(postal_address);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_POSTAL_ADDRESS_TYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_postal_address_get_ext_type(postal_address), fd, IODEFV2_MSG_POSTAL_ADDRESS_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_postal_address_get_p_address(postal_address), fd, IODEFV2_MSG_POSTAL_ADDRESS_P_ADDRESS);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_postal_address_get_description(postal_address), fd, IODEFV2_MSG_POSTAL_ADDRESS_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_node_role_write:
 * @node_role: Pointer to a #iodefv2_node_role_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @node_role within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_node_role_write(iodefv2_node_role_t *node_role, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! node_role )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_NODE_ROLE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_node_role_get_category(node_role), fd, IODEFV2_MSG_NODE_ROLE_CATEGORY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_node_role_get_ext_category(node_role), fd, IODEFV2_MSG_NODE_ROLE_EXT_CATEGORY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_node_role_get_description(node_role), fd, IODEFV2_MSG_NODE_ROLE_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_incident_id_write:
 * @incident_id: Pointer to a #iodefv2_incident_id_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @incident_id within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_incident_id_write(iodefv2_incident_id_t *incident_id, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! incident_id )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INCIDENT_ID_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_incident_id_get_instance(incident_id), fd, IODEFV2_MSG_INCIDENT_ID_INSTANCE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_incident_id_get_ext_restriction(incident_id), fd, IODEFV2_MSG_INCIDENT_ID_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_incident_id_get_name(incident_id), fd, IODEFV2_MSG_INCIDENT_ID_NAME);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_incident_id_restriction_t *tmp;

                tmp = iodefv2_incident_id_get_restriction(incident_id);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INCIDENT_ID_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_alternative_indicator_id_write:
 * @alternative_indicator_id: Pointer to a #iodefv2_alternative_indicator_id_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @alternative_indicator_id within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_alternative_indicator_id_write(iodefv2_alternative_indicator_id_t *alternative_indicator_id, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! alternative_indicator_id )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_alternative_indicator_id_restriction_t *tmp;

                tmp = iodefv2_alternative_indicator_id_get_restriction(alternative_indicator_id);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_alternative_indicator_id_get_ext_restriction(alternative_indicator_id), fd, IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_alternative_indicator_id_get_indicator_reference(alternative_indicator_id), fd, IODEFV2_MSG_ALTERNATIVE_INDICATOR_ID_INDICATOR_REFERENCE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_confidence_write:
 * @confidence: Pointer to a #iodefv2_confidence_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @confidence within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_confidence_write(iodefv2_confidence_t *confidence, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! confidence )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_CONFIDENCE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_confidence_get_rating(confidence), fd, IODEFV2_MSG_CONFIDENCE_RATING);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_confidence_get_ext_rating(confidence), fd, IODEFV2_MSG_CONFIDENCE_EXT_RATING);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}




/**
 * iodefv2_system_impact_write:
 * @system_impact: Pointer to a #iodefv2_system_impact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @system_impact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_system_impact_write(iodefv2_system_impact_t *system_impact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! system_impact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SYSTEM_IMPACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_system_impact_completion_t *tmp;

                tmp = iodefv2_system_impact_get_completion(system_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_IMPACT_COMPLETION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = uint32_write(iodefv2_system_impact_get_type(system_impact), fd, IODEFV2_MSG_SYSTEM_IMPACT_TYPE);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_system_impact_severity_t *tmp;

                tmp = iodefv2_system_impact_get_severity(system_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_IMPACT_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_system_impact_get_ext_type(system_impact), fd, IODEFV2_MSG_SYSTEM_IMPACT_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_system_impact_get_description(system_impact), fd, IODEFV2_MSG_SYSTEM_IMPACT_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_software_reference_write:
 * @software_reference: Pointer to a #iodefv2_software_reference_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @software_reference within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_software_reference_write(iodefv2_software_reference_t *software_reference, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! software_reference )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SOFTWARE_REFERENCE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_software_reference_dtype_t *tmp;

                tmp = iodefv2_software_reference_get_dtype(software_reference);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SOFTWARE_REFERENCE_DTYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_software_reference_get_ext_spec_name(software_reference), fd, IODEFV2_MSG_SOFTWARE_REFERENCE_EXT_SPEC_NAME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_software_reference_get_ext_dtype(software_reference), fd, IODEFV2_MSG_SOFTWARE_REFERENCE_EXT_DTYPE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_business_impact_write:
 * @business_impact: Pointer to a #iodefv2_business_impact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @business_impact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_business_impact_write(iodefv2_business_impact_t *business_impact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! business_impact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_BUSINESS_IMPACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_business_impact_get_ext_severity(business_impact), fd, IODEFV2_MSG_BUSINESS_IMPACT_EXT_SEVERITY);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_business_impact_get_type(business_impact), fd, IODEFV2_MSG_BUSINESS_IMPACT_TYPE);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_business_impact_severity_t *tmp;

                tmp = iodefv2_business_impact_get_severity(business_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_BUSINESS_IMPACT_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_business_impact_get_ext_type(business_impact), fd, IODEFV2_MSG_BUSINESS_IMPACT_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_business_impact_get_description(business_impact), fd, IODEFV2_MSG_BUSINESS_IMPACT_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_indicator_reference_write:
 * @indicator_reference: Pointer to a #iodefv2_indicator_reference_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @indicator_reference within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_reference_write(iodefv2_indicator_reference_t *indicator_reference, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! indicator_reference )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INDICATOR_REFERENCE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_indicator_reference_get_uid_ref(indicator_reference), fd, IODEFV2_MSG_INDICATOR_REFERENCE_UID_REF);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_indicator_reference_get_version(indicator_reference), fd, IODEFV2_MSG_INDICATOR_REFERENCE_VERSION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_indicator_reference_get_euid_ref(indicator_reference), fd, IODEFV2_MSG_INDICATOR_REFERENCE_EUID_REF);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_email_write:
 * @email: Pointer to a #iodefv2_email_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @email within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_email_write(iodefv2_email_t *email, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! email )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_EMAIL_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_email_type_t *tmp;

                tmp = iodefv2_email_get_type(email);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_EMAIL_TYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_email_get_ext_type(email), fd, IODEFV2_MSG_EMAIL_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_get_email_to(email), fd, IODEFV2_MSG_EMAIL_EMAIL_TO);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_get_description(email), fd, IODEFV2_MSG_EMAIL_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_intended_impact_write:
 * @intended_impact: Pointer to a #iodefv2_intended_impact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @intended_impact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_intended_impact_write(iodefv2_intended_impact_t *intended_impact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! intended_impact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INTENDED_IMPACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_intended_impact_get_ext_severity(intended_impact), fd, IODEFV2_MSG_INTENDED_IMPACT_EXT_SEVERITY);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_intended_impact_get_type(intended_impact), fd, IODEFV2_MSG_INTENDED_IMPACT_TYPE);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_intended_impact_severity_t *tmp;

                tmp = iodefv2_intended_impact_get_severity(intended_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INTENDED_IMPACT_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_intended_impact_get_ext_type(intended_impact), fd, IODEFV2_MSG_INTENDED_IMPACT_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_intended_impact_get_description(intended_impact), fd, IODEFV2_MSG_INTENDED_IMPACT_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_additional_data_write:
 * @additional_data: Pointer to a #iodefv2_additional_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @additional_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_additional_data_write(iodefv2_additional_data_t *additional_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! additional_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ADDITIONAL_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_restriction_t *tmp;

                tmp = iodefv2_additional_data_get_restriction(additional_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_ADDITIONAL_DATA_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_additional_data_get_name(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_NAME);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_additional_data_get_type(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_additional_data_get_ext_restriction(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_additional_data_get_formatid(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_FORMATID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_additional_data_get_observable_id(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_additional_data_get_meaning(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_MEANING);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_additional_data_get_ext_dtype(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_EXT_DTYPE);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_data_write(iodefv2_additional_data_get_data(additional_data), fd, IODEFV2_MSG_ADDITIONAL_DATA_DATA);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}




/**
 * iodefv2_counter_write:
 * @counter: Pointer to a #iodefv2_counter_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @counter within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_counter_write(iodefv2_counter_t *counter, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! counter )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_COUNTER_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_counter_get_meaning(counter), fd, IODEFV2_MSG_COUNTER_MEANING);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_counter_get_unit(counter), fd, IODEFV2_MSG_COUNTER_UNIT);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_counter_get_ext_type(counter), fd, IODEFV2_MSG_COUNTER_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_counter_duration_t *tmp;

                tmp = iodefv2_counter_get_duration(counter);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_COUNTER_DURATION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_counter_get_ext_unit(counter), fd, IODEFV2_MSG_COUNTER_EXT_UNIT);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_counter_get_type(counter), fd, IODEFV2_MSG_COUNTER_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_counter_get_ext_duration(counter), fd, IODEFV2_MSG_COUNTER_EXT_DURATION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_monetary_impact_write:
 * @monetary_impact: Pointer to a #iodefv2_monetary_impact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @monetary_impact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_monetary_impact_write(iodefv2_monetary_impact_t *monetary_impact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! monetary_impact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_MONETARY_IMPACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_monetary_impact_get_currency(monetary_impact), fd, IODEFV2_MSG_MONETARY_IMPACT_CURRENCY);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_monetary_impact_severity_t *tmp;

                tmp = iodefv2_monetary_impact_get_severity(monetary_impact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_MONETARY_IMPACT_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_service_name_write:
 * @service_name: Pointer to a #iodefv2_service_name_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @service_name within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_service_name_write(iodefv2_service_name_t *service_name, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! service_name )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SERVICE_NAME_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_service_name_get_url(service_name), fd, IODEFV2_MSG_SERVICE_NAME_URL);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_service_name_get_iana_service(service_name), fd, IODEFV2_MSG_SERVICE_NAME_IANA_SERVICE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_service_name_get_description(service_name), fd, IODEFV2_MSG_SERVICE_NAME_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_indicator_id_write:
 * @indicator_id: Pointer to a #iodefv2_indicator_id_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @indicator_id within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_id_write(iodefv2_indicator_id_t *indicator_id, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! indicator_id )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INDICATOR_ID_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_indicator_id_get_version(indicator_id), fd, IODEFV2_MSG_INDICATOR_ID_VERSION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_indicator_id_get_name(indicator_id), fd, IODEFV2_MSG_INDICATOR_ID_NAME);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_signature_data_write:
 * @signature_data: Pointer to a #iodefv2_signature_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @signature_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_signature_data_write(iodefv2_signature_data_t *signature_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! signature_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SIGNATURE_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_signature_data_get_signature(signature_data), fd, IODEFV2_MSG_SIGNATURE_DATA_SIGNATURE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_address_write:
 * @address: Pointer to a #iodefv2_address_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @address within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_address_write(iodefv2_address_t *address, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! address )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ADDRESS_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_address_get_category(address), fd, IODEFV2_MSG_ADDRESS_CATEGORY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_address_get_vlan_name(address), fd, IODEFV2_MSG_ADDRESS_VLAN_NAME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_address_get_ext_category(address), fd, IODEFV2_MSG_ADDRESS_EXT_CATEGORY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_address_get_vlan_num(address), fd, IODEFV2_MSG_ADDRESS_VLAN_NUM);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_address_get_observable_id(address), fd, IODEFV2_MSG_ADDRESS_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_application_header_write:
 * @application_header: Pointer to a #iodefv2_application_header_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @application_header within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_application_header_write(iodefv2_application_header_t *application_header, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! application_header )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_APPLICATION_HEADER_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_application_header_get_next_additional_data(application_header, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_certificate_data_write:
 * @certificate_data: Pointer to a #iodefv2_certificate_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @certificate_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_certificate_data_write(iodefv2_certificate_data_t *certificate_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! certificate_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_CERTIFICATE_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_certificate_data_restriction_t *tmp;

                tmp = iodefv2_certificate_data_get_restriction(certificate_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_CERTIFICATE_DATA_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_certificate_data_get_ext_restriction(certificate_data), fd, IODEFV2_MSG_CERTIFICATE_DATA_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_certificate_data_get_observable_id(certificate_data), fd, IODEFV2_MSG_CERTIFICATE_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_certificate_t *certificate = NULL;


                while ( (certificate = iodefv2_certificate_data_get_next_certificate(certificate_data, certificate)) ) {
                        ret = iodefv2_certificate_write(certificate, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_threat_actor_write:
 * @threat_actor: Pointer to a #iodefv2_threat_actor_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @threat_actor within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_threat_actor_write(iodefv2_threat_actor_t *threat_actor, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! threat_actor )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_THREAT_ACTOR_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_threat_actor_restriction_t *tmp;

                tmp = iodefv2_threat_actor_get_restriction(threat_actor);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_THREAT_ACTOR_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_threat_actor_get_ext_restriction(threat_actor), fd, IODEFV2_MSG_THREAT_ACTOR_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_threat_actor_get_url(threat_actor), fd, IODEFV2_MSG_THREAT_ACTOR_URL);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_threat_actor_get_threat_actor_id(threat_actor), fd, IODEFV2_MSG_THREAT_ACTOR_THREAT_ACTOR_ID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_threat_actor_get_description(threat_actor), fd, IODEFV2_MSG_THREAT_ACTOR_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_threat_actor_get_next_additional_data(threat_actor, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_method_write:
 * @method: Pointer to a #iodefv2_method_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @method within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_method_write(iodefv2_method_t *method, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! method )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_METHOD_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_method_restriction_t *tmp;

                tmp = iodefv2_method_get_restriction(method);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_METHOD_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_method_get_ext_restriction(method), fd, IODEFV2_MSG_METHOD_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_method_get_next_additional_data(method, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_method_get_description(method), fd, IODEFV2_MSG_METHOD_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_reference_t *reference = NULL;


                while ( (reference = iodefv2_method_get_next_reference(method, reference)) ) {
                        ret = iodefv2_reference_write(reference, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_alternative_id_write:
 * @alternative_id: Pointer to a #iodefv2_alternative_id_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @alternative_id within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_alternative_id_write(iodefv2_alternative_id_t *alternative_id, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! alternative_id )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ALTERNATIVE_ID_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_alternative_id_restriction_t *tmp;

                tmp = iodefv2_alternative_id_get_restriction(alternative_id);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_ALTERNATIVE_ID_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_alternative_id_get_ext_restriction(alternative_id), fd, IODEFV2_MSG_ALTERNATIVE_ID_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_incident_id_t *incident_id = NULL;


                while ( (incident_id = iodefv2_alternative_id_get_next_incident_id(alternative_id, incident_id)) ) {
                        ret = iodefv2_incident_id_write(incident_id, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_software_write:
 * @software: Pointer to a #iodefv2_software_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @software within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_software_write(iodefv2_software_t *software, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! software )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SOFTWARE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_software_get_url(software), fd, IODEFV2_MSG_SOFTWARE_URL);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_software_get_description(software), fd, IODEFV2_MSG_SOFTWARE_DESCRIPTION);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_software_reference_write(iodefv2_software_get_software_reference(software), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_nameservers_write:
 * @nameservers: Pointer to a #iodefv2_nameservers_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @nameservers within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_nameservers_write(iodefv2_nameservers_t *nameservers, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! nameservers )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_NAMESERVERS_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_address_t *address = NULL;


                while ( (address = iodefv2_nameservers_get_next_address(nameservers, address)) ) {
                        ret = iodefv2_address_write(address, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_nameservers_get_server(nameservers), fd, IODEFV2_MSG_NAMESERVERS_SERVER);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_windows_registry_keys_modified_write:
 * @windows_registry_keys_modified: Pointer to a #iodefv2_windows_registry_keys_modified_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @windows_registry_keys_modified within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_windows_registry_keys_modified_write(iodefv2_windows_registry_keys_modified_t *windows_registry_keys_modified, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! windows_registry_keys_modified )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_WINDOWS_REGISTRY_KEYS_MODIFIED_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_windows_registry_keys_modified_get_observable_id(windows_registry_keys_modified), fd, IODEFV2_MSG_WINDOWS_REGISTRY_KEYS_MODIFIED_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_key_t *key = NULL;


                while ( (key = iodefv2_windows_registry_keys_modified_get_next_key(windows_registry_keys_modified, key)) ) {
                        ret = iodefv2_key_write(key, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_campaign_write:
 * @campaign: Pointer to a #iodefv2_campaign_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @campaign within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_campaign_write(iodefv2_campaign_t *campaign, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! campaign )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_CAMPAIGN_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_campaign_restriction_t *tmp;

                tmp = iodefv2_campaign_get_restriction(campaign);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_CAMPAIGN_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_campaign_get_ext_restriction(campaign), fd, IODEFV2_MSG_CAMPAIGN_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_campaign_get_url(campaign), fd, IODEFV2_MSG_CAMPAIGN_URL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_campaign_get_next_additional_data(campaign, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_campaign_get_description(campaign), fd, IODEFV2_MSG_CAMPAIGN_DESCRIPTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_campaign_get_campaign_id(campaign), fd, IODEFV2_MSG_CAMPAIGN_CAMPAIGN_ID);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_assessment_write:
 * @assessment: Pointer to a #iodefv2_assessment_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @assessment within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_assessment_write(iodefv2_assessment_t *assessment, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! assessment )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ASSESSMENT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_assessment_restriction_t *tmp;

                tmp = iodefv2_assessment_get_restriction(assessment);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_ASSESSMENT_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_assessment_get_ext_restriction(assessment), fd, IODEFV2_MSG_ASSESSMENT_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_assessment_occurrence_t *tmp;

                tmp = iodefv2_assessment_get_occurrence(assessment);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_ASSESSMENT_OCCURRENCE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_assessment_get_observable_id(assessment), fd, IODEFV2_MSG_ASSESSMENT_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_intended_impact_t *intended_impact = NULL;


                while ( (intended_impact = iodefv2_assessment_get_next_intended_impact(assessment, intended_impact)) ) {
                        ret = iodefv2_intended_impact_write(intended_impact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_confidence_write(iodefv2_assessment_get_confidence(assessment), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_time_impact_t *time_impact = NULL;


                while ( (time_impact = iodefv2_assessment_get_next_time_impact(assessment, time_impact)) ) {
                        ret = iodefv2_time_impact_write(time_impact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_assessment_get_next_additional_data(assessment, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_monetary_impact_t *monetary_impact = NULL;


                while ( (monetary_impact = iodefv2_assessment_get_next_monetary_impact(assessment, monetary_impact)) ) {
                        ret = iodefv2_monetary_impact_write(monetary_impact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_counter_t *counter = NULL;


                while ( (counter = iodefv2_assessment_get_next_counter(assessment, counter)) ) {
                        ret = iodefv2_counter_write(counter, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_system_impact_t *system_impact = NULL;


                while ( (system_impact = iodefv2_assessment_get_next_system_impact(assessment, system_impact)) ) {
                        ret = iodefv2_system_impact_write(system_impact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_business_impact_t *business_impact = NULL;


                while ( (business_impact = iodefv2_assessment_get_next_business_impact(assessment, business_impact)) ) {
                        ret = iodefv2_business_impact_write(business_impact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_assessment_get_incident_category(assessment), fd, IODEFV2_MSG_ASSESSMENT_INCIDENT_CATEGORY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_assessment_get_mitigating_factor(assessment), fd, IODEFV2_MSG_ASSESSMENT_MITIGATING_FACTOR);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_assessment_get_cause(assessment), fd, IODEFV2_MSG_ASSESSMENT_CAUSE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_attack_phase_write:
 * @attack_phase: Pointer to a #iodefv2_attack_phase_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @attack_phase within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_attack_phase_write(iodefv2_attack_phase_t *attack_phase, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! attack_phase )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_ATTACK_PHASE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_attack_phase_get_url(attack_phase), fd, IODEFV2_MSG_ATTACK_PHASE_URL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_attack_phase_get_next_additional_data(attack_phase, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_attack_phase_get_description(attack_phase), fd, IODEFV2_MSG_ATTACK_PHASE_DESCRIPTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_attack_phase_get_attack_phase_id(attack_phase), fd, IODEFV2_MSG_ATTACK_PHASE_ATTACK_PHASE_ID);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}




/**
 * iodefv2_contact_write:
 * @contact: Pointer to a #iodefv2_contact_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @contact within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_contact_write(iodefv2_contact_t *contact, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! contact )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_CONTACT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_contact_restriction_t *tmp;

                tmp = iodefv2_contact_get_restriction(contact);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_CONTACT_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = uint32_write(iodefv2_contact_get_role(contact), fd, IODEFV2_MSG_CONTACT_ROLE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_contact_get_ext_type(contact), fd, IODEFV2_MSG_CONTACT_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_contact_get_ext_role(contact), fd, IODEFV2_MSG_CONTACT_EXT_ROLE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_contact_get_ext_restriction(contact), fd, IODEFV2_MSG_CONTACT_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_contact_get_type(contact), fd, IODEFV2_MSG_CONTACT_TYPE);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_contact_get_next_additional_data(contact, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_contact_get_contact_title(contact), fd, IODEFV2_MSG_CONTACT_CONTACT_TITLE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_contact_get_description(contact), fd, IODEFV2_MSG_CONTACT_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_telephone_t *telephone = NULL;


                while ( (telephone = iodefv2_contact_get_next_telephone(contact, telephone)) ) {
                        ret = iodefv2_telephone_write(telephone, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_email_t *email = NULL;


                while ( (email = iodefv2_contact_get_next_email(contact, email)) ) {
                        ret = iodefv2_email_write(email, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_contact_get_contact_name(contact), fd, IODEFV2_MSG_CONTACT_CONTACT_NAME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_contact_get_timezone(contact), fd, IODEFV2_MSG_CONTACT_TIMEZONE);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_postal_address_t *postal_address = NULL;


                while ( (postal_address = iodefv2_contact_get_next_postal_address(contact, postal_address)) ) {
                        ret = iodefv2_postal_address_write(postal_address, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_registry_handle_t *registry_handle = NULL;


                while ( (registry_handle = iodefv2_contact_get_next_registry_handle(contact, registry_handle)) ) {
                        ret = iodefv2_registry_handle_write(registry_handle, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_related_activity_write:
 * @related_activity: Pointer to a #iodefv2_related_activity_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @related_activity within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_related_activity_write(iodefv2_related_activity_t *related_activity, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! related_activity )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_RELATED_ACTIVITY_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_related_activity_restriction_t *tmp;

                tmp = iodefv2_related_activity_get_restriction(related_activity);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RELATED_ACTIVITY_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_related_activity_get_ext_restriction(related_activity), fd, IODEFV2_MSG_RELATED_ACTIVITY_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_related_activity_get_next_additional_data(related_activity, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_confidence_write(iodefv2_related_activity_get_confidence(related_activity), fd);
         if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_related_activity_get_description(related_activity), fd, IODEFV2_MSG_RELATED_ACTIVITY_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_campaign_t *campaign = NULL;


                while ( (campaign = iodefv2_related_activity_get_next_campaign(related_activity, campaign)) ) {
                        ret = iodefv2_campaign_write(campaign, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_related_activity_get_url(related_activity), fd, IODEFV2_MSG_RELATED_ACTIVITY_URL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_threat_actor_t *threat_actor = NULL;


                while ( (threat_actor = iodefv2_related_activity_get_next_threat_actor(related_activity, threat_actor)) ) {
                        ret = iodefv2_threat_actor_write(threat_actor, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_indicator_id_t *indicator_id = NULL;


                while ( (indicator_id = iodefv2_related_activity_get_next_indicator_id(related_activity, indicator_id)) ) {
                        ret = iodefv2_indicator_id_write(indicator_id, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_incident_id_t *incident_id = NULL;


                while ( (incident_id = iodefv2_related_activity_get_next_incident_id(related_activity, incident_id)) ) {
                        ret = iodefv2_incident_id_write(incident_id, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_domain_contacts_write:
 * @domain_contacts: Pointer to a #iodefv2_domain_contacts_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @domain_contacts within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_domain_contacts_write(iodefv2_domain_contacts_t *domain_contacts, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! domain_contacts )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_DOMAIN_CONTACTS_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_contact_t *contact = NULL;


                while ( (contact = iodefv2_domain_contacts_get_next_contact(domain_contacts, contact)) ) {
                        ret = iodefv2_contact_write(contact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_domain_contacts_get_same_domain_contact(domain_contacts), fd, IODEFV2_MSG_DOMAIN_CONTACTS_SAME_DOMAIN_CONTACT);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_history_item_write:
 * @history_item: Pointer to a #iodefv2_history_item_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @history_item within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_history_item_write(iodefv2_history_item_t *history_item, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! history_item )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_HISTORY_ITEM_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_history_item_get_action(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_ACTION);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_history_item_restriction_t *tmp;

                tmp = iodefv2_history_item_get_restriction(history_item);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_HISTORY_ITEM_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_history_item_get_ext_action(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_EXT_ACTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_history_item_get_ext_restriction(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_history_item_get_observable_id(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_history_item_get_next_additional_data(history_item, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_contact_write(iodefv2_history_item_get_contact(history_item), fd);
         if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_history_item_get_defined_coa(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_DEFINED_COA);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_history_item_get_description(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_DESCRIPTION);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_incident_id_write(iodefv2_history_item_get_incident_id(history_item), fd);
         if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_history_item_get_date_time(history_item), fd, IODEFV2_MSG_HISTORY_ITEM_DATE_TIME);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_fuzzy_hash_write:
 * @fuzzy_hash: Pointer to a #iodefv2_fuzzy_hash_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @fuzzy_hash within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_fuzzy_hash_write(iodefv2_fuzzy_hash_t *fuzzy_hash, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! fuzzy_hash )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_FUZZY_HASH_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_fuzzy_hash_get_next_additional_data(fuzzy_hash, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_software_write(iodefv2_fuzzy_hash_get_software(fuzzy_hash), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_hash_write:
 * @hash: Pointer to a #iodefv2_hash_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @hash within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_hash_write(iodefv2_hash_t *hash, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! hash )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_HASH_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_hash_get_digest_value(hash), fd, IODEFV2_MSG_HASH_DIGEST_VALUE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_hash_get_digest_method(hash), fd, IODEFV2_MSG_HASH_DIGEST_METHOD);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_hash_get_canonicalization_method(hash), fd, IODEFV2_MSG_HASH_CANONICALIZATION_METHOD);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_software_write(iodefv2_hash_get_software(hash), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_detection_pattern_write:
 * @detection_pattern: Pointer to a #iodefv2_detection_pattern_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @detection_pattern within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_detection_pattern_write(iodefv2_detection_pattern_t *detection_pattern, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! detection_pattern )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_DETECTION_PATTERN_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_detection_pattern_restriction_t *tmp;

                tmp = iodefv2_detection_pattern_get_restriction(detection_pattern);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_DETECTION_PATTERN_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_detection_pattern_get_ext_restriction(detection_pattern), fd, IODEFV2_MSG_DETECTION_PATTERN_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_detection_pattern_get_observable_id(detection_pattern), fd, IODEFV2_MSG_DETECTION_PATTERN_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_detection_pattern_get_detection_configuration(detection_pattern), fd, IODEFV2_MSG_DETECTION_PATTERN_DETECTION_CONFIGURATION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_detection_pattern_get_description(detection_pattern), fd, IODEFV2_MSG_DETECTION_PATTERN_DESCRIPTION);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_software_write(iodefv2_detection_pattern_get_software(detection_pattern), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}




/**
 * iodefv2_expectation_write:
 * @expectation: Pointer to a #iodefv2_expectation_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @expectation within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_expectation_write(iodefv2_expectation_t *expectation, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! expectation )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_EXPECTATION_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_expectation_restriction_t *tmp;

                tmp = iodefv2_expectation_get_restriction(expectation);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_EXPECTATION_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_expectation_get_ext_action(expectation), fd, IODEFV2_MSG_EXPECTATION_EXT_ACTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_expectation_get_ext_severity(expectation), fd, IODEFV2_MSG_EXPECTATION_EXT_SEVERITY);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_expectation_severity_t *tmp;

                tmp = iodefv2_expectation_get_severity(expectation);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_EXPECTATION_SEVERITY);
                        if ( ret < 0 )
                                return ret;
                }
        }


        {
                iodefv2_expectation_action_t *tmp;

                tmp = iodefv2_expectation_get_action(expectation);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_EXPECTATION_ACTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_expectation_get_ext_restriction(expectation), fd, IODEFV2_MSG_EXPECTATION_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_expectation_get_end_time(expectation), fd, IODEFV2_MSG_EXPECTATION_END_TIME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_expectation_get_defined_coa(expectation), fd, IODEFV2_MSG_EXPECTATION_DEFINED_COA);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_expectation_get_description(expectation), fd, IODEFV2_MSG_EXPECTATION_DESCRIPTION);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_expectation_get_start_time(expectation), fd, IODEFV2_MSG_EXPECTATION_START_TIME);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_contact_write(iodefv2_expectation_get_contact(expectation), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_domain_data_write:
 * @domain_data: Pointer to a #iodefv2_domain_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @domain_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_domain_data_write(iodefv2_domain_data_t *domain_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! domain_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_DOMAIN_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_domain_data_get_ext_domain_status(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_EXT_DOMAIN_STATUS);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_domain_data_get_domain_status(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_DOMAIN_STATUS);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_domain_data_get_ext_system_status(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_EXT_SYSTEM_STATUS);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_domain_data_get_observable_id(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_domain_data_get_system_status(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_SYSTEM_STATUS);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_domain_data_get_next_additional_data(domain_data, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_domain_data_get_name(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_NAME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_nameservers_t *nameservers = NULL;


                while ( (nameservers = iodefv2_domain_data_get_next_nameservers(domain_data, nameservers)) ) {
                        ret = iodefv2_nameservers_write(nameservers, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_domain_data_get_registration_date(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_REGISTRATION_DATE);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_domain_contacts_write(iodefv2_domain_data_get_domain_contacts(domain_data), fd);
         if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_domain_data_get_date_domain_was_checked(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_DATE_DOMAIN_WAS_CHECKED);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_domain_data_get_expiration_date(domain_data), fd, IODEFV2_MSG_DOMAIN_DATA_EXPIRATION_DATE);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_hash_data_write:
 * @hash_data: Pointer to a #iodefv2_hash_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @hash_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_hash_data_write(iodefv2_hash_data_t *hash_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! hash_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_HASH_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_hash_data_scope_t *tmp;

                tmp = iodefv2_hash_data_get_scope(hash_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_HASH_DATA_SCOPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_hash_data_get_ext_scope(hash_data), fd, IODEFV2_MSG_HASH_DATA_EXT_SCOPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_hash_data_get_hash_target_id(hash_data), fd, IODEFV2_MSG_HASH_DATA_HASH_TARGET_ID);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_hash_write(iodefv2_hash_data_get_hash(hash_data), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_fuzzy_hash_write(iodefv2_hash_data_get_fuzzy_hash(hash_data), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_bulk_observable_format_write:
 * @bulk_observable_format: Pointer to a #iodefv2_bulk_observable_format_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @bulk_observable_format within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_bulk_observable_format_write(iodefv2_bulk_observable_format_t *bulk_observable_format, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! bulk_observable_format )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_BULK_OBSERVABLE_FORMAT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_bulk_observable_format_get_next_additional_data(bulk_observable_format, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_hash_write(iodefv2_bulk_observable_format_get_hash(bulk_observable_format), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_history_write:
 * @history: Pointer to a #iodefv2_history_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @history within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_history_write(iodefv2_history_t *history, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! history )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_HISTORY_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_history_restriction_t *tmp;

                tmp = iodefv2_history_get_restriction(history);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_HISTORY_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_history_item_t *history_item = NULL;


                while ( (history_item = iodefv2_history_get_next_history_item(history, history_item)) ) {
                        ret = iodefv2_history_item_write(history_item, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}



/**
 * iodefv2_discovery_write:
 * @discovery: Pointer to a #iodefv2_discovery_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @discovery within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_discovery_write(iodefv2_discovery_t *discovery, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! discovery )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_DISCOVERY_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_discovery_source_t *tmp;

                tmp = iodefv2_discovery_get_source(discovery);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_DISCOVERY_SOURCE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_discovery_get_ext_restriction(discovery), fd, IODEFV2_MSG_DISCOVERY_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_discovery_get_ext_source(discovery), fd, IODEFV2_MSG_DISCOVERY_EXT_SOURCE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_discovery_get_observable_id(discovery), fd, IODEFV2_MSG_DISCOVERY_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_discovery_restriction_t *tmp;

                tmp = iodefv2_discovery_get_restriction(discovery);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_DISCOVERY_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_detection_pattern_t *detection_pattern = NULL;


                while ( (detection_pattern = iodefv2_discovery_get_next_detection_pattern(discovery, detection_pattern)) ) {
                        ret = iodefv2_detection_pattern_write(detection_pattern, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_contact_t *contact = NULL;


                while ( (contact = iodefv2_discovery_get_next_contact(discovery, contact)) ) {
                        ret = iodefv2_contact_write(contact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_discovery_get_description(discovery), fd, IODEFV2_MSG_DISCOVERY_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_bulk_observable_write:
 * @bulk_observable: Pointer to a #iodefv2_bulk_observable_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @bulk_observable within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_bulk_observable_write(iodefv2_bulk_observable_t *bulk_observable, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! bulk_observable )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_BULK_OBSERVABLE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_bulk_observable_type_t *tmp;

                tmp = iodefv2_bulk_observable_get_type(bulk_observable);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_BULK_OBSERVABLE_TYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_bulk_observable_get_ext_type(bulk_observable), fd, IODEFV2_MSG_BULK_OBSERVABLE_EXT_TYPE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_bulk_observable_get_bulk_observable_list(bulk_observable), fd, IODEFV2_MSG_BULK_OBSERVABLE_BULK_OBSERVABLE_LIST);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_bulk_observable_format_write(iodefv2_bulk_observable_get_bulk_observable_format(bulk_observable), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_bulk_observable_get_next_additional_data(bulk_observable, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_email_data_write:
 * @email_data: Pointer to a #iodefv2_email_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @email_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_email_data_write(iodefv2_email_data_t *email_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! email_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_EMAIL_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_email_data_get_observable_id(email_data), fd, IODEFV2_MSG_EMAIL_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_email_data_get_next_additional_data(email_data, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_email_data_get_email_headers(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_HEADERS);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_signature_data_t *signature_data = NULL;


                while ( (signature_data = iodefv2_email_data_get_next_signature_data(email_data, signature_data)) ) {
                        ret = iodefv2_signature_data_write(signature_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_email_data_get_email_subject(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_SUBJECT);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_data_get_email_x_mailer(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_X_MAILER);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_hash_data_t *hash_data = NULL;


                while ( (hash_data = iodefv2_email_data_get_next_hash_data(email_data, hash_data)) ) {
                        ret = iodefv2_hash_data_write(hash_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_email_data_get_email_from(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_FROM);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_application_header_write(iodefv2_email_data_get_application_header(email_data), fd);
         if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_data_get_email_body(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_BODY);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_data_get_email_message(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_MESSAGE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_email_data_get_email_to(email_data), fd, IODEFV2_MSG_EMAIL_DATA_EMAIL_TO);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_file_write:
 * @file: Pointer to a #iodefv2_file_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @file within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_file_write(iodefv2_file_t *file, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! file )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_FILE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_file_get_observable_id(file), fd, IODEFV2_MSG_FILE_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_hash_data_write(iodefv2_file_get_hash_data(file), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_file_get_next_additional_data(file, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_signature_data_write(iodefv2_file_get_signature_data(file), fd);
         if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_file_get_url(file), fd, IODEFV2_MSG_FILE_URL);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_software_write(iodefv2_file_get_software(file), fd);
         if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_file_get_file_name(file), fd, IODEFV2_MSG_FILE_FILE_NAME);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_node_write:
 * @node: Pointer to a #iodefv2_node_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @node within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_node_write(iodefv2_node_t *node, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! node )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_NODE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = libiodefv2_string_write(iodefv2_node_get_postal_address(node), fd, IODEFV2_MSG_NODE_POSTAL_ADDRESS);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_counter_t *counter = NULL;


                while ( (counter = iodefv2_node_get_next_counter(node, counter)) ) {
                        ret = iodefv2_counter_write(counter, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_node_get_location(node), fd, IODEFV2_MSG_NODE_LOCATION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_domain_data_t *domain_data = NULL;


                while ( (domain_data = iodefv2_node_get_next_domain_data(node, domain_data)) ) {
                        ret = iodefv2_domain_data_write(domain_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_address_t *address = NULL;


                while ( (address = iodefv2_node_get_next_address(node, address)) ) {
                        ret = iodefv2_address_write(address, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_service_write:
 * @service: Pointer to a #iodefv2_service_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @service within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_service_write(iodefv2_service_t *service, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! service )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SERVICE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_service_get_ip_protocol(service), fd, IODEFV2_MSG_SERVICE_IP_PROTOCOL);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_service_get_observable_id(service), fd, IODEFV2_MSG_SERVICE_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        {
                uint32_t *tmp;

                tmp = iodefv2_service_get_proto_code(service);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SERVICE_PROTO_CODE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_service_get_portlist(service), fd, IODEFV2_MSG_SERVICE_PORTLIST);
        if ( ret < 0 )
                return ret;


        {
                uint32_t *tmp;

                tmp = iodefv2_service_get_proto_field(service);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SERVICE_PROTO_FIELD);
                        if ( ret < 0 )
                                return ret;
                }
        }

         ret = iodefv2_service_name_write(iodefv2_service_get_service_name(service), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_application_header_write(iodefv2_service_get_application_header(service), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_email_data_write(iodefv2_service_get_email_data(service), fd);
         if ( ret < 0 )
                return ret;


        {
                uint32_t *tmp;

                tmp = iodefv2_service_get_proto_type(service);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SERVICE_PROTO_TYPE);
                        if ( ret < 0 )
                                return ret;
                }
        }


        {
                uint32_t *tmp;

                tmp = iodefv2_service_get_port(service);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SERVICE_PORT);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_software_t *software = NULL;


                while ( (software = iodefv2_service_get_next_software(service, software)) ) {
                        ret = iodefv2_software_write(software, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_file_data_write:
 * @file_data: Pointer to a #iodefv2_file_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @file_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_file_data_write(iodefv2_file_data_t *file_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! file_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_FILE_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_file_data_restriction_t *tmp;

                tmp = iodefv2_file_data_get_restriction(file_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_FILE_DATA_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_file_data_get_ext_restriction(file_data), fd, IODEFV2_MSG_FILE_DATA_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_file_data_get_observable_id(file_data), fd, IODEFV2_MSG_FILE_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_file_t *file = NULL;


                while ( (file = iodefv2_file_data_get_next_file(file_data, file)) ) {
                        ret = iodefv2_file_write(file, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}






/**
 * iodefv2_system_write:
 * @system: Pointer to a #iodefv2_system_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @system within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_system_write(iodefv2_system_t *system, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! system )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_SYSTEM_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_system_get_category(system), fd, IODEFV2_MSG_SYSTEM_CATEGORY);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_system_restriction_t *tmp;

                tmp = iodefv2_system_get_restriction(system);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_system_get_ext_restriction(system), fd, IODEFV2_MSG_SYSTEM_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_system_get_ext_ownership(system), fd, IODEFV2_MSG_SYSTEM_EXT_OWNERSHIP);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_system_get_ext_category(system), fd, IODEFV2_MSG_SYSTEM_EXT_CATEGORY);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_system_spoofed_t *tmp;

                tmp = iodefv2_system_get_spoofed(system);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_SPOOFED);
                        if ( ret < 0 )
                                return ret;
                }
        }


        {
                iodefv2_system_virtual_t *tmp;

                tmp = iodefv2_system_get_virtual(system);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_VIRTUAL);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_system_get_observable_id(system), fd, IODEFV2_MSG_SYSTEM_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_system_ownership_t *tmp;

                tmp = iodefv2_system_get_ownership(system);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_SYSTEM_OWNERSHIP);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_system_get_interface(system), fd, IODEFV2_MSG_SYSTEM_INTERFACE);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_node_write(iodefv2_system_get_node(system), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_system_get_next_additional_data(system, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_system_get_description(system), fd, IODEFV2_MSG_SYSTEM_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_service_t *service = NULL;


                while ( (service = iodefv2_system_get_next_service(system, service)) ) {
                        ret = iodefv2_service_write(service, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_system_get_asset_id(system), fd, IODEFV2_MSG_SYSTEM_ASSET_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_counter_t *counter = NULL;


                while ( (counter = iodefv2_system_get_next_counter(system, counter)) ) {
                        ret = iodefv2_counter_write(counter, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_node_role_t *node_role = NULL;


                while ( (node_role = iodefv2_system_get_next_node_role(system, node_role)) ) {
                        ret = iodefv2_node_role_write(node_role, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_software_write(iodefv2_system_get_software(system), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_record_data_write:
 * @record_data: Pointer to a #iodefv2_record_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @record_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_data_write(iodefv2_record_data_t *record_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! record_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_RECORD_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_record_data_restriction_t *tmp;

                tmp = iodefv2_record_data_get_restriction(record_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RECORD_DATA_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_record_data_get_ext_restriction(record_data), fd, IODEFV2_MSG_RECORD_DATA_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_record_data_get_observable_id(record_data), fd, IODEFV2_MSG_RECORD_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_record_data_get_next_additional_data(record_data, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = libiodefv2_string_write(iodefv2_record_data_get_description(record_data), fd, IODEFV2_MSG_RECORD_DATA_DESCRIPTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_record_data_get_url(record_data), fd, IODEFV2_MSG_RECORD_DATA_URL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_certificate_data_t *certificate_data = NULL;


                while ( (certificate_data = iodefv2_record_data_get_next_certificate_data(record_data, certificate_data)) ) {
                        ret = iodefv2_certificate_data_write(certificate_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_record_pattern_t *record_pattern = NULL;


                while ( (record_pattern = iodefv2_record_data_get_next_record_pattern(record_data, record_pattern)) ) {
                        ret = iodefv2_record_pattern_write(record_pattern, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_record_data_get_date_time(record_data), fd, IODEFV2_MSG_RECORD_DATA_DATE_TIME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_windows_registry_keys_modified_t *windows_registry_keys_modified = NULL;


                while ( (windows_registry_keys_modified = iodefv2_record_data_get_next_windows_registry_keys_modified(record_data, windows_registry_keys_modified)) ) {
                        ret = iodefv2_windows_registry_keys_modified_write(windows_registry_keys_modified, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_file_data_t *file_data = NULL;


                while ( (file_data = iodefv2_record_data_get_next_file_data(record_data, file_data)) ) {
                        ret = iodefv2_file_data_write(file_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_software_write(iodefv2_record_data_get_software(record_data), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_record_write:
 * @record: Pointer to a #iodefv2_record_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @record within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_record_write(iodefv2_record_t *record, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! record )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_RECORD_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_record_restriction_t *tmp;

                tmp = iodefv2_record_get_restriction(record);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_RECORD_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_record_get_ext_restriction(record), fd, IODEFV2_MSG_RECORD_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_record_data_t *record_data = NULL;


                while ( (record_data = iodefv2_record_get_next_record_data(record, record_data)) ) {
                        ret = iodefv2_record_data_write(record_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_flow_write:
 * @flow: Pointer to a #iodefv2_flow_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @flow within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_flow_write(iodefv2_flow_t *flow, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! flow )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_FLOW_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_system_t *system = NULL;


                while ( (system = iodefv2_flow_get_next_system(flow, system)) ) {
                        ret = iodefv2_system_write(system, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_event_data_write:
 * @event_data: Pointer to a #iodefv2_event_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @event_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_event_data_write(iodefv2_event_data_t *event_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! event_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_EVENT_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_event_data_restriction_t *tmp;

                tmp = iodefv2_event_data_get_restriction(event_data);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_EVENT_DATA_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_event_data_get_ext_restriction(event_data), fd, IODEFV2_MSG_EVENT_DATA_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_event_data_get_observable_id(event_data), fd, IODEFV2_MSG_EVENT_DATA_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_event_data_get_detect_time(event_data), fd, IODEFV2_MSG_EVENT_DATA_DETECT_TIME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_event_data_get_next_additional_data(event_data, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_event_data_get_report_time(event_data), fd, IODEFV2_MSG_EVENT_DATA_REPORT_TIME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_event_data_get_description(event_data), fd, IODEFV2_MSG_EVENT_DATA_DESCRIPTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_flow_t *flow = NULL;


                while ( (flow = iodefv2_event_data_get_next_flow(event_data, flow)) ) {
                        ret = iodefv2_flow_write(flow, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_expectation_t *expectation = NULL;


                while ( (expectation = iodefv2_event_data_get_next_expectation(event_data, expectation)) ) {
                        ret = iodefv2_expectation_write(expectation, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_record_write(iodefv2_event_data_get_record(event_data), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_contact_t *contact = NULL;


                while ( (contact = iodefv2_event_data_get_next_contact(event_data, contact)) ) {
                        ret = iodefv2_contact_write(contact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_event_data_get_start_time(event_data), fd, IODEFV2_MSG_EVENT_DATA_START_TIME);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_event_data_get_end_time(event_data), fd, IODEFV2_MSG_EVENT_DATA_END_TIME);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_assessment_write(iodefv2_event_data_get_assessment(event_data), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_method_t *method = NULL;


                while ( (method = iodefv2_event_data_get_next_method(event_data, method)) ) {
                        ret = iodefv2_method_write(method, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_event_data_get_recovery_time(event_data), fd, IODEFV2_MSG_EVENT_DATA_RECOVERY_TIME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_discovery_t *discovery = NULL;


                while ( (discovery = iodefv2_event_data_get_next_discovery(event_data, discovery)) ) {
                        ret = iodefv2_discovery_write(discovery, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_observable_write:
 * @observable: Pointer to a #iodefv2_observable_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @observable within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_observable_write(iodefv2_observable_t *observable, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! observable )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_OBSERVABLE_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_observable_restriction_t *tmp;

                tmp = iodefv2_observable_get_restriction(observable);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_OBSERVABLE_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_observable_get_ext_restriction(observable), fd, IODEFV2_MSG_OBSERVABLE_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_detection_pattern_write(iodefv2_observable_get_detection_pattern(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_service_write(iodefv2_observable_get_service(observable), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_observable_get_next_additional_data(observable, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_system_write(iodefv2_observable_get_system(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_domain_data_write(iodefv2_observable_get_domain_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_email_data_write(iodefv2_observable_get_email_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_assessment_write(iodefv2_observable_get_assessment(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_record_data_write(iodefv2_observable_get_record_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_reference_write(iodefv2_observable_get_reference(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_history_item_write(iodefv2_observable_get_history_item(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_bulk_observable_write(iodefv2_observable_get_bulk_observable(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_certificate_data_write(iodefv2_observable_get_certificate_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_expectation_write(iodefv2_observable_get_expectation(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_windows_registry_keys_modified_write(iodefv2_observable_get_windows_registry_keys_modified(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_address_write(iodefv2_observable_get_address(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_event_data_write(iodefv2_observable_get_event_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_file_data_write(iodefv2_observable_get_file_data(observable), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_registry_handle_write(iodefv2_observable_get_registry_handle(observable), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_indicator_expression_write:
 * @indicator_expression: Pointer to a #iodefv2_indicator_expression_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @indicator_expression within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_expression_write(iodefv2_indicator_expression_t *indicator_expression, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! indicator_expression )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INDICATOR_EXPRESSION_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_indicator_expression_operator_t *tmp;

                tmp = iodefv2_indicator_expression_get_operator(indicator_expression);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INDICATOR_EXPRESSION_OPERATOR);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_indicator_expression_get_ext_operator(indicator_expression), fd, IODEFV2_MSG_INDICATOR_EXPRESSION_EXT_OPERATOR);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_indicator_reference_t *indicator_reference = NULL;


                while ( (indicator_reference = iodefv2_indicator_expression_get_next_indicator_reference(indicator_expression, indicator_reference)) ) {
                        ret = iodefv2_indicator_reference_write(indicator_reference, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_observable_t *observable = NULL;


                while ( (observable = iodefv2_indicator_expression_get_next_observable(indicator_expression, observable)) ) {
                        ret = iodefv2_observable_write(observable, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_confidence_write(iodefv2_indicator_expression_get_confidence(indicator_expression), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_indicator_expression_t *indicator_expression = NULL;


                while ( (indicator_expression = iodefv2_indicator_expression_get_next_indicator_expression(indicator_expression, indicator_expression)) ) {
                        ret = iodefv2_indicator_expression_write(indicator_expression, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_indicator_expression_get_next_additional_data(indicator_expression, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_indicator_write:
 * @indicator: Pointer to a #iodefv2_indicator_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @indicator within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_write(iodefv2_indicator_t *indicator, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! indicator )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INDICATOR_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_indicator_restriction_t *tmp;

                tmp = iodefv2_indicator_get_restriction(indicator);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INDICATOR_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_indicator_get_ext_restriction(indicator), fd, IODEFV2_MSG_INDICATOR_EXT_RESTRICTION);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_alternative_indicator_id_t *alternative_indicator_id = NULL;


                while ( (alternative_indicator_id = iodefv2_indicator_get_next_alternative_indicator_id(indicator, alternative_indicator_id)) ) {
                        ret = iodefv2_alternative_indicator_id_write(alternative_indicator_id, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_confidence_write(iodefv2_indicator_get_confidence(indicator), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_reference_t *reference = NULL;


                while ( (reference = iodefv2_indicator_get_next_reference(indicator, reference)) ) {
                        ret = iodefv2_reference_write(reference, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_observable_write(iodefv2_indicator_get_observable(indicator), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_indicator_get_next_additional_data(indicator, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_indicator_expression_write(iodefv2_indicator_get_indicator_expression(indicator), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_contact_t *contact = NULL;


                while ( (contact = iodefv2_indicator_get_next_contact(indicator, contact)) ) {
                        ret = iodefv2_contact_write(contact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_node_role_t *node_role = NULL;


                while ( (node_role = iodefv2_indicator_get_next_node_role(indicator, node_role)) ) {
                        ret = iodefv2_node_role_write(node_role, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_indicator_get_start_time(indicator), fd, IODEFV2_MSG_INDICATOR_START_TIME);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_indicator_id_write(iodefv2_indicator_get_indicator_id(indicator), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_indicator_reference_write(iodefv2_indicator_get_indicator_reference(indicator), fd);
         if ( ret < 0 )
                return ret;

         ret = iodefv2_observable_reference_write(iodefv2_indicator_get_observable_reference(indicator), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_attack_phase_t *attack_phase = NULL;


                while ( (attack_phase = iodefv2_indicator_get_next_attack_phase(indicator, attack_phase)) ) {
                        ret = iodefv2_attack_phase_write(attack_phase, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_indicator_get_end_time(indicator), fd, IODEFV2_MSG_INDICATOR_END_TIME);
        if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}

/**
 * iodefv2_indicator_data_write:
 * @indicator_data: Pointer to a #iodefv2_indicator_data_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @indicator_data within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_indicator_data_write(iodefv2_indicator_data_t *indicator_data, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! indicator_data )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INDICATOR_DATA_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;
        {
                iodefv2_indicator_t *indicator = NULL;


                while ( (indicator = iodefv2_indicator_data_get_next_indicator(indicator_data, indicator)) ) {
                        ret = iodefv2_indicator_write(indicator, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}





/**
 * iodefv2_incident_write:
 * @incident: Pointer to a #iodefv2_incident_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @incident within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_incident_write(iodefv2_incident_t *incident, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! incident )
            return 0;

        ret = binary_write(fd,  IODEFV2_MSG_INCIDENT_TAG, 0, NULL);
        if ( ret < 0 )
                return ret;

        ret = uint32_write(iodefv2_incident_get_status(incident), fd, IODEFV2_MSG_INCIDENT_STATUS);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_incident_lang_t *tmp;

                tmp = iodefv2_incident_get_lang(incident);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INCIDENT_LANG);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_incident_get_ext_purpose(incident), fd, IODEFV2_MSG_INCIDENT_EXT_PURPOSE);
        if ( ret < 0 )
                return ret;


        ret = uint32_write(iodefv2_incident_get_purpose(incident), fd, IODEFV2_MSG_INCIDENT_PURPOSE);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_incident_get_ext_status(incident), fd, IODEFV2_MSG_INCIDENT_EXT_STATUS);
        if ( ret < 0 )
                return ret;


        {
                iodefv2_incident_restriction_t *tmp;

                tmp = iodefv2_incident_get_restriction(incident);
                if ( tmp ) {
                        ret = uint32_write(*tmp, fd, IODEFV2_MSG_INCIDENT_RESTRICTION);
                        if ( ret < 0 )
                                return ret;
                }
        }


        ret = libiodefv2_string_write(iodefv2_incident_get_observable_id(incident), fd, IODEFV2_MSG_INCIDENT_OBSERVABLE_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_incident_get_next_additional_data(incident, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_history_write(iodefv2_incident_get_history(incident), fd);
         if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_incident_get_start_time(incident), fd, IODEFV2_MSG_INCIDENT_START_TIME);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_alternative_id_write(iodefv2_incident_get_alternative_id(incident), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_contact_t *contact = NULL;


                while ( (contact = iodefv2_incident_get_next_contact(incident, contact)) ) {
                        ret = iodefv2_contact_write(contact, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_related_activity_write(iodefv2_incident_get_related_activity(incident), fd);
         if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_incident_get_end_time(incident), fd, IODEFV2_MSG_INCIDENT_END_TIME);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_incident_get_generation_time(incident), fd, IODEFV2_MSG_INCIDENT_GENERATION_TIME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_assessment_t *assessment = NULL;


                while ( (assessment = iodefv2_incident_get_next_assessment(incident, assessment)) ) {
                        ret = iodefv2_assessment_write(assessment, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_method_t *method = NULL;


                while ( (method = iodefv2_incident_get_next_method(incident, method)) ) {
                        ret = iodefv2_method_write(method, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_incident_get_recovery_time(incident), fd, IODEFV2_MSG_INCIDENT_RECOVERY_TIME);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_discovery_t *discovery = NULL;


                while ( (discovery = iodefv2_incident_get_next_discovery(incident, discovery)) ) {
                        ret = iodefv2_discovery_write(discovery, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }

        ret = iodefv2_time_write(iodefv2_incident_get_detect_time(incident), fd, IODEFV2_MSG_INCIDENT_DETECT_TIME);
        if ( ret < 0 )
                return ret;


        ret = iodefv2_time_write(iodefv2_incident_get_report_time(incident), fd, IODEFV2_MSG_INCIDENT_REPORT_TIME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_incident_get_description(incident), fd, IODEFV2_MSG_INCIDENT_DESCRIPTION);
        if ( ret < 0 )
                return ret;

         ret = iodefv2_indicator_data_write(iodefv2_incident_get_indicator_data(incident), fd);
         if ( ret < 0 )
                return ret;

        {
                iodefv2_event_data_t *event_data = NULL;


                while ( (event_data = iodefv2_incident_get_next_event_data(incident, event_data)) ) {
                        ret = iodefv2_event_data_write(event_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
         ret = iodefv2_incident_id_write(iodefv2_incident_get_incident_id(incident), fd);
         if ( ret < 0 )
                return ret;

        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


/**
 * iodefv2_document_write:
 * @document: Pointer to a #iodefv2_document_t object.
 * @msg: Pointer to a #libiodefv2_msgbuf_t object, where the message should be written.
 *
 * Write @document within @msg message buffer. The buffer is
 * associated with a #libiodefv2_io_t file descriptor where the data will be written.
 *
 * Returns: 0 on success, a negative value if an error occured.
 */
int iodefv2_document_write(iodefv2_document_t *document, libiodefv2_io_t *fd)
{
        int ret;
        if ( ! document )
            return 0;


        ret = uint32_write(iodefv2_document_get_lang(document), fd, IODEFV2_MSG_DOCUMENT_LANG);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_document_get_formatid(document), fd, IODEFV2_MSG_DOCUMENT_FORMATID);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_document_get_version(document), fd, IODEFV2_MSG_DOCUMENT_VERSION);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_document_get_private_enum_name(document), fd, IODEFV2_MSG_DOCUMENT_PRIVATE_ENUM_NAME);
        if ( ret < 0 )
                return ret;


        ret = libiodefv2_string_write(iodefv2_document_get_private_enum_id(document), fd, IODEFV2_MSG_DOCUMENT_PRIVATE_ENUM_ID);
        if ( ret < 0 )
                return ret;

        {
                iodefv2_additional_data_t *additional_data = NULL;


                while ( (additional_data = iodefv2_document_get_next_additional_data(document, additional_data)) ) {
                        ret = iodefv2_additional_data_write(additional_data, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        {
                iodefv2_incident_t *incident = NULL;


                while ( (incident = iodefv2_document_get_next_incident(document, incident)) ) {
                        ret = iodefv2_incident_write(incident, fd);
                        if ( ret < 0 )
                                return ret;
            }
        }
        return binary_write(fd, IODEFV2_MSG_END_OF_TAG, 0, NULL);
}


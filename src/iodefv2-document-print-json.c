
/*****
*
* Copyright (C) 2004-2016 CS-SI. All Rights Reserved.
* Author: Yoann Vandoorselaere <yoann.v@prelude-ids.com>
* Author: Nicolas Delon <nicolas.delon@prelude-ids.com>
*
* This file is part of the Libiodefv2 library.
*
* This program is free software; you can redistribute it and/or modify
* it under the terms of the GNU General Public License as published by
* the Free Software Foundation; either version 2, or (at your option)
* any later version.
*
* This program is distributed in the hope that it will be useful,
* but WITHOUT ANY WARRANTY; without even the implied warranty of
* MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
* GNU General Public License for more details.
*
* You should have received a copy of the GNU General Public License along
* with this program; if not, write to the Free Software Foundation, Inc.,
* 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
*
*****/

/*
 * This file was automatically generated by our generator, version 1
 *
 * Do not make changes to this file unless you know what you are doing.
 * modify the template interface file instead.
 * IODEFV2 version : RFC5070-bis-26
 * Template file: generate-top-level-class-print-json.c.mako
 *
 */

#include "config.h"
#include "libmissing.h"

#include <stdio.h>
#include <string.h>

#include "iodefv2.h"
#include "iodefv2-tree-wrap.h"
#include "iodefv2-document-print-json.h"


#define conv_uint8 conv_uint64
#define conv_uint16 conv_uint64
#define conv_uint32 conv_uint64
#define conv_int8 conv_int64
#define conv_int16 conv_int64
#define conv_int32 conv_int64


static int conv_uint64(libiodefv2_io_t *fd, uint64_t value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%" LIBIODEFV2_PRIu64, value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libiodefv2_io_write(fd, buf, ret);
}


static int conv_int64(libiodefv2_io_t *fd, int64_t value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%" LIBIODEFV2_PRId64, value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libiodefv2_io_write(fd, buf, ret);
}


static int conv_float(libiodefv2_io_t *fd, float value)
{
        int ret;
        char buf[32];

        ret = snprintf(buf, sizeof(buf), "%f", value);
        if ( ret < 0 || ret >= sizeof(buf) )
                return -1;

        return libiodefv2_io_write(fd, buf, ret);
}


static int conv_string(libiodefv2_io_t *fd, libiodefv2_string_t *string)
{
        size_t i;
        ssize_t ret;
        const unsigned char *content;

        content = (const unsigned char *) libiodefv2_string_get_string_or_default(string, "");
        ret = libiodefv2_io_write(fd, "\"", 1);
        if ( ret < 0 )
                return ret;

        for ( i = 0; i < libiodefv2_string_get_len(string); i++, content++ ) {
                switch(*content) {
                        case '\\':
                        case '"':
                        case '/':
                                ret = libiodefv2_io_write(fd, "\\", 1);
                                if ( ret < 0 )
                                        return ret;

                                ret = libiodefv2_io_write(fd, content, 1);
                                break;
                        case '\b':
                                ret = libiodefv2_io_write(fd, "\\b", 2);
                                break;
                        case '\t':
                                ret = libiodefv2_io_write(fd, "\\t", 2);
                                break;
                        case '\n':
                                ret = libiodefv2_io_write(fd, "\\n", 2);
                                break;
                        case '\f':
                                ret = libiodefv2_io_write(fd, "\\f", 2);
                                break;
                        case '\r':
                                ret = libiodefv2_io_write(fd, "\\r", 2);
                                break;
                        default:
                                if ( *content >= 0x20 )
                                        ret = libiodefv2_io_write(fd, content, 1);
                                else {
                                        char seq[7];
                                        snprintf(seq, sizeof(seq), "\\u%04X", *content);
                                        ret = libiodefv2_io_write(fd, seq, strlen(seq));
                                }
                }

                if ( ret < 0 )
                        return ret;
        }

        return libiodefv2_io_write(fd, "\"", 1);
}


static int conv_time(libiodefv2_io_t *fd, iodefv2_time_t *t)
{
        int ret;
        libiodefv2_string_t *str;

        if ( ! t )
                return 0;

        ret = libiodefv2_string_new(&str);
        if ( ret < 0 )
                return ret;

        ret = iodefv2_time_to_string(t, str);
        if ( ret < 0 )
                goto error;

        ret = conv_string(fd, str);

error:
        libiodefv2_string_destroy(str);
        return ret;
}


static int conv_data(libiodefv2_io_t *fd, iodefv2_data_t *data)
{
        int ret;
        libiodefv2_string_t *out;

        ret = libiodefv2_string_new(&out);
        if ( ret < 0 )
                return ret;

        ret = iodefv2_data_to_string(data, out);
        if ( ret < 0 )
                goto error;

        switch (iodefv2_data_get_type(data)) {
                case IODEFV2_DATA_TYPE_INT:
                case IODEFV2_DATA_TYPE_FLOAT:
                        ret = libiodefv2_io_write(fd, libiodefv2_string_get_string(out), libiodefv2_string_get_len(out));
                        break;
                default:
                        ret = conv_string(fd, out);
                        break;
        }
error:
        libiodefv2_string_destroy(out);
        return ret;
}


static int do_write(libiodefv2_io_t *fd, const char *str)
{
        return libiodefv2_io_write(fd, str, strlen(str));
}
/**
 * iodefv2_telephone_json:
 * @ptr: Pointer to an iodefv2_telephone_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_telephone_print_json(iodefv2_telephone_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_telephone_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_telephone_get_type(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_telephone_type_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_telephone_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_telephone_get_telephone_number(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"telephone_number\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_telephone_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_certificate_json:
 * @ptr: Pointer to an iodefv2_certificate_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_certificate_print_json(iodefv2_certificate_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_certificate_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_certificate_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_data_t *field;

                field = iodefv2_certificate_get_x509_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"x509_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_data(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_certificate_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_key_json:
 * @ptr: Pointer to an iodefv2_key_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_key_print_json(iodefv2_key_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_key_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_key_get_registryaction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_key_registryaction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"registryaction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_key_get_ext_registryaction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_registryaction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_key_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_key_get_key_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"key_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_key_get_key_value(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"key_value\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_observable_reference_json:
 * @ptr: Pointer to an iodefv2_observable_reference_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_observable_reference_print_json(iodefv2_observable_reference_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_observable_reference_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_observable_reference_get_uid_ref(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"uid_ref\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_registry_handle_json:
 * @ptr: Pointer to an iodefv2_registry_handle_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_registry_handle_print_json(iodefv2_registry_handle_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_registry_handle_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_registry_handle_get_registry(ptr);
{
                        const char *enumstr = iodefv2_registry_handle_registry_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"registry\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_registry_handle_get_ext_registry(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_registry\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_time_impact_json:
 * @ptr: Pointer to an iodefv2_time_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_time_impact_print_json(iodefv2_time_impact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_time_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_time_impact_get_ext_metric(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_metric\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_time_impact_get_duration(ptr);
{
                        const char *enumstr = iodefv2_time_impact_duration_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"duration\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = iodefv2_time_impact_get_metric(ptr);
{
                        const char *enumstr = iodefv2_time_impact_metric_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"metric\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_time_impact_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_time_impact_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_time_impact_get_ext_duration(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_duration\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_record_pattern_json:
 * @ptr: Pointer to an iodefv2_record_pattern_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_record_pattern_print_json(iodefv2_record_pattern_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_record_pattern_t\"");
        if ( ret < 0 )
                return ret;

        {
                uint32_t *field;

                field = iodefv2_record_pattern_get_instance(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"instance\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_pattern_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = iodefv2_record_pattern_get_offset(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"offset\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_record_pattern_get_offsetunit(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_record_pattern_offsetunit_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"offsetunit\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_pattern_get_ext_offsetunit(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_offsetunit\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_record_pattern_get_type(ptr);
{
                        const char *enumstr = iodefv2_record_pattern_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_reference_json:
 * @ptr: Pointer to an iodefv2_reference_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_reference_print_json(iodefv2_reference_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_reference_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_reference_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_reference_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_reference_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_reference_get_reference_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"reference_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_postal_address_json:
 * @ptr: Pointer to an iodefv2_postal_address_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_postal_address_print_json(iodefv2_postal_address_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_postal_address_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_postal_address_get_type(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_postal_address_type_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_postal_address_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_postal_address_get_p_address(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"p_address\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_postal_address_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_node_role_json:
 * @ptr: Pointer to an iodefv2_node_role_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_node_role_print_json(iodefv2_node_role_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_node_role_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_node_role_get_category(ptr);
{
                        const char *enumstr = iodefv2_node_role_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_node_role_get_ext_category(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_category\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_node_role_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_incident_id_json:
 * @ptr: Pointer to an iodefv2_incident_id_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_incident_id_print_json(iodefv2_incident_id_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_incident_id_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_id_get_instance(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"instance\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_id_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_id_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_incident_id_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_incident_id_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_alternative_indicator_id_json:
 * @ptr: Pointer to an iodefv2_alternative_indicator_id_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_alternative_indicator_id_print_json(iodefv2_alternative_indicator_id_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_alternative_indicator_id_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_alternative_indicator_id_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_alternative_indicator_id_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_alternative_indicator_id_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_alternative_indicator_id_get_indicator_reference(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"indicator_reference\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_confidence_json:
 * @ptr: Pointer to an iodefv2_confidence_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_confidence_print_json(iodefv2_confidence_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_confidence_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_confidence_get_rating(ptr);
{
                        const char *enumstr = iodefv2_confidence_rating_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"rating\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_confidence_get_ext_rating(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_rating\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_system_impact_json:
 * @ptr: Pointer to an iodefv2_system_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_system_impact_print_json(iodefv2_system_impact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_system_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_system_impact_get_completion(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_impact_completion_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"completion\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = iodefv2_system_impact_get_type(ptr);
{
                        const char *enumstr = iodefv2_system_impact_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_system_impact_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_impact_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_impact_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_impact_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_software_reference_json:
 * @ptr: Pointer to an iodefv2_software_reference_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_software_reference_print_json(iodefv2_software_reference_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_software_reference_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_software_reference_get_dtype(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_software_reference_dtype_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"dtype\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_software_reference_get_ext_spec_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_spec_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_software_reference_get_ext_dtype(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_dtype\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_business_impact_json:
 * @ptr: Pointer to an iodefv2_business_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_business_impact_print_json(iodefv2_business_impact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_business_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_business_impact_get_ext_severity(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_severity\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_business_impact_get_type(ptr);
{
                        const char *enumstr = iodefv2_business_impact_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_business_impact_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_business_impact_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_business_impact_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_business_impact_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_indicator_reference_json:
 * @ptr: Pointer to an iodefv2_indicator_reference_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_indicator_reference_print_json(iodefv2_indicator_reference_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_indicator_reference_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_reference_get_uid_ref(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"uid_ref\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_reference_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_reference_get_euid_ref(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"euid_ref\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_email_json:
 * @ptr: Pointer to an iodefv2_email_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_email_print_json(iodefv2_email_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_email_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_email_get_type(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_email_type_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_get_email_to(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_to\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_intended_impact_json:
 * @ptr: Pointer to an iodefv2_intended_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_intended_impact_print_json(iodefv2_intended_impact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_intended_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_intended_impact_get_ext_severity(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_severity\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_intended_impact_get_type(ptr);
{
                        const char *enumstr = iodefv2_intended_impact_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_intended_impact_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_intended_impact_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_intended_impact_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_intended_impact_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_additional_data_json:
 * @ptr: Pointer to an iodefv2_additional_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_additional_data_print_json(iodefv2_additional_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_additional_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_additional_data_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_additional_data_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_additional_data_get_type(ptr);
{
                        const char *enumstr = iodefv2_additional_data_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_formatid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"formatid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_additional_data_get_ext_dtype(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_dtype\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_data_t *field;

                field = iodefv2_additional_data_get_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_data(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_counter_json:
 * @ptr: Pointer to an iodefv2_counter_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_counter_print_json(iodefv2_counter_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_counter_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_counter_get_meaning(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"meaning\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_counter_get_unit(ptr);
{
                        const char *enumstr = iodefv2_counter_unit_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"unit\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_counter_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_counter_get_duration(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_counter_duration_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"duration\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_counter_get_ext_unit(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_unit\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_counter_get_type(ptr);
{
                        const char *enumstr = iodefv2_counter_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_counter_get_ext_duration(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_duration\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_monetary_impact_json:
 * @ptr: Pointer to an iodefv2_monetary_impact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_monetary_impact_print_json(iodefv2_monetary_impact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_monetary_impact_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_monetary_impact_get_currency(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"currency\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_monetary_impact_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_monetary_impact_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_service_name_json:
 * @ptr: Pointer to an iodefv2_service_name_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_service_name_print_json(iodefv2_service_name_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_service_name_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_service_name_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_service_name_get_iana_service(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"iana_service\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_service_name_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_indicator_id_json:
 * @ptr: Pointer to an iodefv2_indicator_id_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_indicator_id_print_json(iodefv2_indicator_id_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_indicator_id_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_id_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_id_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_signature_data_json:
 * @ptr: Pointer to an iodefv2_signature_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_signature_data_print_json(iodefv2_signature_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_signature_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_signature_data_get_signature(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"signature\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_address_json:
 * @ptr: Pointer to an iodefv2_address_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_address_print_json(iodefv2_address_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_address_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_address_get_category(ptr);
{
                        const char *enumstr = iodefv2_address_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_address_get_vlan_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"vlan_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_address_get_ext_category(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_category\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_address_get_vlan_num(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"vlan_num\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_address_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_application_header_json:
 * @ptr: Pointer to an iodefv2_application_header_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_application_header_print_json(iodefv2_application_header_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_application_header_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_application_header_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_certificate_data_json:
 * @ptr: Pointer to an iodefv2_certificate_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_certificate_data_print_json(iodefv2_certificate_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_certificate_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_certificate_data_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_certificate_data_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_certificate_data_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_certificate_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_certificate_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_certificate_data_get_next_certificate(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"certificate\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_certificate_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_threat_actor_json:
 * @ptr: Pointer to an iodefv2_threat_actor_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_threat_actor_print_json(iodefv2_threat_actor_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_threat_actor_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_threat_actor_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_threat_actor_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_threat_actor_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_threat_actor_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_threat_actor_get_threat_actor_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"threat_actor_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_threat_actor_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_threat_actor_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_method_json:
 * @ptr: Pointer to an iodefv2_method_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_method_print_json(iodefv2_method_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_method_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_method_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_method_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_method_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_method_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_method_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_reference_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_method_get_next_reference(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"reference\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_reference_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_alternative_id_json:
 * @ptr: Pointer to an iodefv2_alternative_id_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_alternative_id_print_json(iodefv2_alternative_id_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_alternative_id_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_alternative_id_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_alternative_id_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_alternative_id_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_incident_id_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_alternative_id_get_next_incident_id(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"incident_id\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_incident_id_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_software_json:
 * @ptr: Pointer to an iodefv2_software_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_software_print_json(iodefv2_software_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_software_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_software_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_software_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_reference_t *field;

                field = iodefv2_software_get_software_reference(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software_reference\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_reference_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_nameservers_json:
 * @ptr: Pointer to an iodefv2_nameservers_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_nameservers_print_json(iodefv2_nameservers_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_nameservers_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_address_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_nameservers_get_next_address(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"address\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_address_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_nameservers_get_server(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"server\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_windows_registry_keys_modified_json:
 * @ptr: Pointer to an iodefv2_windows_registry_keys_modified_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_windows_registry_keys_modified_print_json(iodefv2_windows_registry_keys_modified_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_windows_registry_keys_modified_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_windows_registry_keys_modified_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_key_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_windows_registry_keys_modified_get_next_key(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"key\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_key_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_campaign_json:
 * @ptr: Pointer to an iodefv2_campaign_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_campaign_print_json(iodefv2_campaign_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_campaign_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_campaign_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_campaign_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_campaign_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_campaign_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_campaign_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_campaign_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_campaign_get_campaign_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"campaign_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_assessment_json:
 * @ptr: Pointer to an iodefv2_assessment_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_assessment_print_json(iodefv2_assessment_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_assessment_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_assessment_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_assessment_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_assessment_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_assessment_get_occurrence(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_assessment_occurrence_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"occurrence\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_assessment_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_intended_impact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_intended_impact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"intended_impact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_intended_impact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_confidence_t *field;

                field = iodefv2_assessment_get_confidence(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"confidence\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_confidence_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_time_impact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_time_impact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"time_impact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_time_impact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_monetary_impact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_monetary_impact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"monetary_impact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_monetary_impact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_counter_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_counter(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"counter\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_counter_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_system_impact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_system_impact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"system_impact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_system_impact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_business_impact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_assessment_get_next_business_impact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"business_impact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_business_impact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_assessment_get_incident_category(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"incident_category\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_assessment_get_mitigating_factor(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"mitigating_factor\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_assessment_get_cause(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"cause\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_attack_phase_json:
 * @ptr: Pointer to an iodefv2_attack_phase_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_attack_phase_print_json(iodefv2_attack_phase_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_attack_phase_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_attack_phase_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_attack_phase_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_attack_phase_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_attack_phase_get_attack_phase_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"attack_phase_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_contact_json:
 * @ptr: Pointer to an iodefv2_contact_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_contact_print_json(iodefv2_contact_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_contact_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_contact_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_contact_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int i = iodefv2_contact_get_role(ptr);
{
                        const char *enumstr = iodefv2_contact_role_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"role\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_ext_role(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_role\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_contact_get_type(ptr);
{
                        const char *enumstr = iodefv2_contact_type_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_contact_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_contact_title(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"contact_title\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_telephone_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_contact_get_next_telephone(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"telephone\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_telephone_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_email_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_contact_get_next_email(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"email\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_email_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_contact_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"contact_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_contact_get_timezone(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"timezone\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_postal_address_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_contact_get_next_postal_address(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"postal_address\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_postal_address_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_registry_handle_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_contact_get_next_registry_handle(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"registry_handle\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_registry_handle_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_related_activity_json:
 * @ptr: Pointer to an iodefv2_related_activity_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_related_activity_print_json(iodefv2_related_activity_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_related_activity_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_related_activity_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_related_activity_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_related_activity_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_related_activity_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_confidence_t *field;

                field = iodefv2_related_activity_get_confidence(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"confidence\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_confidence_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_related_activity_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_campaign_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_related_activity_get_next_campaign(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"campaign\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_campaign_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_related_activity_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_threat_actor_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_related_activity_get_next_threat_actor(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"threat_actor\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_threat_actor_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_indicator_id_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_related_activity_get_next_indicator_id(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"indicator_id\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_indicator_id_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_incident_id_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_related_activity_get_next_incident_id(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"incident_id\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_incident_id_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_domain_contacts_json:
 * @ptr: Pointer to an iodefv2_domain_contacts_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_domain_contacts_print_json(iodefv2_domain_contacts_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_domain_contacts_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_contact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_domain_contacts_get_next_contact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"contact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_contact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_domain_contacts_get_same_domain_contact(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"same_domain_contact\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_history_item_json:
 * @ptr: Pointer to an iodefv2_history_item_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_history_item_print_json(iodefv2_history_item_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_history_item_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_history_item_get_action(ptr);
{
                        const char *enumstr = iodefv2_history_item_action_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"action\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_history_item_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_history_item_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_history_item_get_ext_action(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_action\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_history_item_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_history_item_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_history_item_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_contact_t *field;

                field = iodefv2_history_item_get_contact(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"contact\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_contact_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_history_item_get_defined_coa(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"defined_coa\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_history_item_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_incident_id_t *field;

                field = iodefv2_history_item_get_incident_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"incident_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_incident_id_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_history_item_get_date_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"date_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_fuzzy_hash_json:
 * @ptr: Pointer to an iodefv2_fuzzy_hash_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_fuzzy_hash_print_json(iodefv2_fuzzy_hash_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_fuzzy_hash_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_fuzzy_hash_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_fuzzy_hash_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_hash_json:
 * @ptr: Pointer to an iodefv2_hash_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_hash_print_json(iodefv2_hash_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_hash_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_hash_get_digest_value(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"digest_value\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_hash_get_digest_method(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"digest_method\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_hash_get_canonicalization_method(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"canonicalization_method\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_hash_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_detection_pattern_json:
 * @ptr: Pointer to an iodefv2_detection_pattern_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_detection_pattern_print_json(iodefv2_detection_pattern_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_detection_pattern_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_detection_pattern_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_detection_pattern_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_detection_pattern_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_detection_pattern_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_detection_pattern_get_detection_configuration(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"detection_configuration\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_detection_pattern_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_detection_pattern_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_expectation_json:
 * @ptr: Pointer to an iodefv2_expectation_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_expectation_print_json(iodefv2_expectation_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_expectation_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_expectation_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_expectation_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_expectation_get_ext_action(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_action\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_expectation_get_ext_severity(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_severity\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_expectation_get_severity(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_expectation_severity_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"severity\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_expectation_get_action(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_expectation_action_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"action\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_expectation_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_expectation_get_end_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"end_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_expectation_get_defined_coa(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"defined_coa\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_expectation_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_expectation_get_start_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"start_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_contact_t *field;

                field = iodefv2_expectation_get_contact(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"contact\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_contact_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_domain_data_json:
 * @ptr: Pointer to an iodefv2_domain_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_domain_data_print_json(iodefv2_domain_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_domain_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_domain_data_get_ext_domain_status(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_domain_status\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_domain_data_get_domain_status(ptr);
{
                        const char *enumstr = iodefv2_domain_data_domain_status_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"domain_status\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_domain_data_get_ext_system_status(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_system_status\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_domain_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_domain_data_get_system_status(ptr);
{
                        const char *enumstr = iodefv2_domain_data_system_status_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"system_status\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_domain_data_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_domain_data_get_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_nameservers_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_domain_data_get_next_nameservers(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"nameservers\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_nameservers_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_domain_data_get_registration_date(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"registration_date\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_domain_contacts_t *field;

                field = iodefv2_domain_data_get_domain_contacts(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"domain_contacts\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_domain_contacts_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_domain_data_get_date_domain_was_checked(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"date_domain_was_checked\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_domain_data_get_expiration_date(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"expiration_date\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_hash_data_json:
 * @ptr: Pointer to an iodefv2_hash_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_hash_data_print_json(iodefv2_hash_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_hash_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_hash_data_get_scope(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_hash_data_scope_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"scope\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_hash_data_get_ext_scope(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_scope\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_hash_data_get_hash_target_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"hash_target_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_hash_t *field;

                field = iodefv2_hash_data_get_hash(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"hash\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_hash_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_fuzzy_hash_t *field;

                field = iodefv2_hash_data_get_fuzzy_hash(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"fuzzy_hash\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_fuzzy_hash_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_bulk_observable_format_json:
 * @ptr: Pointer to an iodefv2_bulk_observable_format_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_bulk_observable_format_print_json(iodefv2_bulk_observable_format_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_bulk_observable_format_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_bulk_observable_format_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_hash_t *field;

                field = iodefv2_bulk_observable_format_get_hash(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"hash\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_hash_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_history_json:
 * @ptr: Pointer to an iodefv2_history_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_history_print_json(iodefv2_history_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_history_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_history_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_history_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
{

                iodefv2_history_item_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_history_get_next_history_item(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"history_item\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_history_item_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_discovery_json:
 * @ptr: Pointer to an iodefv2_discovery_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_discovery_print_json(iodefv2_discovery_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_discovery_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_discovery_get_source(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_discovery_source_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"source\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_discovery_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_discovery_get_ext_source(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_source\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_discovery_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_discovery_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_discovery_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }
{

                iodefv2_detection_pattern_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_discovery_get_next_detection_pattern(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"detection_pattern\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_detection_pattern_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_contact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_discovery_get_next_contact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"contact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_contact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_discovery_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_bulk_observable_json:
 * @ptr: Pointer to an iodefv2_bulk_observable_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_bulk_observable_print_json(iodefv2_bulk_observable_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_bulk_observable_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_bulk_observable_get_type(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_bulk_observable_type_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"type\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_bulk_observable_get_ext_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_bulk_observable_get_bulk_observable_list(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"bulk_observable_list\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_bulk_observable_format_t *field;

                field = iodefv2_bulk_observable_get_bulk_observable_format(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"bulk_observable_format\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_bulk_observable_format_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_bulk_observable_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_email_data_json:
 * @ptr: Pointer to an iodefv2_email_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_email_data_print_json(iodefv2_email_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_email_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_email_data_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_headers(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_headers\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_signature_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_email_data_get_next_signature_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"signature_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_signature_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_subject(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_subject\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_x_mailer(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_x_mailer\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_hash_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_email_data_get_next_hash_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"hash_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_hash_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_from(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_from\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_application_header_t *field;

                field = iodefv2_email_data_get_application_header(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"application_header\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_application_header_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_body(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_body\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_message(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_message\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_email_data_get_email_to(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_to\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_file_json:
 * @ptr: Pointer to an iodefv2_file_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_file_print_json(iodefv2_file_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_file_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_file_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_hash_data_t *field;

                field = iodefv2_file_get_hash_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"hash_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_hash_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_file_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_signature_data_t *field;

                field = iodefv2_file_get_signature_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"signature_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_signature_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_file_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_file_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_file_get_file_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_node_json:
 * @ptr: Pointer to an iodefv2_node_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_node_print_json(iodefv2_node_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_node_t\"");
        if ( ret < 0 )
                return ret;

        {
                libiodefv2_string_t *field;

                field = iodefv2_node_get_postal_address(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"postal_address\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_counter_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_node_get_next_counter(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"counter\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_counter_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_node_get_location(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"location\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_domain_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_node_get_next_domain_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"domain_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_domain_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_address_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_node_get_next_address(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"address\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_address_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_service_json:
 * @ptr: Pointer to an iodefv2_service_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_service_print_json(iodefv2_service_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_service_t\"");
        if ( ret < 0 )
                return ret;

        {
                uint32_t field;

                field = iodefv2_service_get_ip_protocol(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ip_protocol\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_service_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = iodefv2_service_get_proto_code(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"proto_code\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_service_get_portlist(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"portlist\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = iodefv2_service_get_proto_field(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"proto_field\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_service_name_t *field;

                field = iodefv2_service_get_service_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"service_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_service_name_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_application_header_t *field;

                field = iodefv2_service_get_application_header(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"application_header\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_application_header_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_email_data_t *field;

                field = iodefv2_service_get_email_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_email_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = iodefv2_service_get_proto_type(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"proto_type\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                uint32_t *field;

                field = iodefv2_service_get_port(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"port\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_uint32(fd, *field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_software_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_service_get_next_software(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"software\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_software_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_file_data_json:
 * @ptr: Pointer to an iodefv2_file_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_file_data_print_json(iodefv2_file_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_file_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_file_data_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_file_data_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_file_data_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_file_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_file_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_file_data_get_next_file(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"file\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_file_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_system_json:
 * @ptr: Pointer to an iodefv2_system_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_system_print_json(iodefv2_system_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_system_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_system_get_category(ptr);
{
                        const char *enumstr = iodefv2_system_category_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"category\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_system_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_ext_ownership(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_ownership\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_ext_category(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_category\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_system_get_spoofed(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_spoofed_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"spoofed\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_system_get_virtual(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_virtual_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"virtual\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_system_get_ownership(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_system_ownership_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"ownership\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_interface(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"interface\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_node_t *field;

                field = iodefv2_system_get_node(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"node\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_node_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_system_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_service_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_system_get_next_service(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"service\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_service_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_system_get_asset_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"asset_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_counter_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_system_get_next_counter(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"counter\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_counter_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_node_role_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_system_get_next_node_role(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"node_role\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_node_role_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_system_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_record_data_json:
 * @ptr: Pointer to an iodefv2_record_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_record_data_print_json(iodefv2_record_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_record_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_record_data_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_record_data_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_data_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_data_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_data_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_data_get_url(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"url\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_certificate_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_data_get_next_certificate_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"certificate_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_certificate_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_record_pattern_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_data_get_next_record_pattern(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"record_pattern\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_record_pattern_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_record_data_get_date_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"date_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_windows_registry_keys_modified_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_data_get_next_windows_registry_keys_modified(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"windows_registry_keys_modified\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_windows_registry_keys_modified_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_file_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_data_get_next_file_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"file_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_file_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_software_t *field;

                field = iodefv2_record_data_get_software(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"software\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_software_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_record_json:
 * @ptr: Pointer to an iodefv2_record_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_record_print_json(iodefv2_record_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_record_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_record_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_record_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_record_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_record_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_record_get_next_record_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"record_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_record_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_flow_json:
 * @ptr: Pointer to an iodefv2_flow_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_flow_print_json(iodefv2_flow_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_flow_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_system_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_flow_get_next_system(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"system\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_system_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_event_data_json:
 * @ptr: Pointer to an iodefv2_event_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_event_data_print_json(iodefv2_event_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_event_data_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_event_data_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_event_data_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_event_data_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_event_data_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_event_data_get_detect_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"detect_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_event_data_get_report_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"report_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_event_data_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_flow_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_flow(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"flow\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_flow_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_expectation_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_expectation(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"expectation\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_expectation_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_record_t *field;

                field = iodefv2_event_data_get_record(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"record\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_record_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_contact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_contact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"contact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_contact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_event_data_get_start_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"start_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_event_data_get_end_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"end_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_assessment_t *field;

                field = iodefv2_event_data_get_assessment(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"assessment\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_assessment_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_method_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_method(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"method\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_method_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_event_data_get_recovery_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"recovery_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_discovery_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_event_data_get_next_discovery(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"discovery\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_discovery_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_observable_json:
 * @ptr: Pointer to an iodefv2_observable_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_observable_print_json(iodefv2_observable_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_observable_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_observable_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_observable_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_observable_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_detection_pattern_t *field;

                field = iodefv2_observable_get_detection_pattern(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"detection_pattern\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_detection_pattern_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_service_t *field;

                field = iodefv2_observable_get_service(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"service\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_service_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_observable_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_system_t *field;

                field = iodefv2_observable_get_system(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"system\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_system_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_domain_data_t *field;

                field = iodefv2_observable_get_domain_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"domain_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_domain_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_email_data_t *field;

                field = iodefv2_observable_get_email_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"email_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_email_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_assessment_t *field;

                field = iodefv2_observable_get_assessment(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"assessment\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_assessment_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_record_data_t *field;

                field = iodefv2_observable_get_record_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"record_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_record_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_reference_t *field;

                field = iodefv2_observable_get_reference(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"reference\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_reference_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_history_item_t *field;

                field = iodefv2_observable_get_history_item(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"history_item\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_history_item_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_bulk_observable_t *field;

                field = iodefv2_observable_get_bulk_observable(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"bulk_observable\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_bulk_observable_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_certificate_data_t *field;

                field = iodefv2_observable_get_certificate_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"certificate_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_certificate_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_expectation_t *field;

                field = iodefv2_observable_get_expectation(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"expectation\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_expectation_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_windows_registry_keys_modified_t *field;

                field = iodefv2_observable_get_windows_registry_keys_modified(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"windows_registry_keys_modified\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_windows_registry_keys_modified_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_address_t *field;

                field = iodefv2_observable_get_address(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"address\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_address_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_event_data_t *field;

                field = iodefv2_observable_get_event_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"event_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_event_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_file_data_t *field;

                field = iodefv2_observable_get_file_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"file_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_file_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_registry_handle_t *field;

                field = iodefv2_observable_get_registry_handle(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"registry_handle\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_registry_handle_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_indicator_expression_json:
 * @ptr: Pointer to an iodefv2_indicator_expression_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_indicator_expression_print_json(iodefv2_indicator_expression_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_indicator_expression_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_indicator_expression_get_operator(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_indicator_expression_operator_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"operator\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_expression_get_ext_operator(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_operator\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_indicator_reference_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_expression_get_next_indicator_reference(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"indicator_reference\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_indicator_reference_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_observable_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_expression_get_next_observable(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"observable\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_observable_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_confidence_t *field;

                field = iodefv2_indicator_expression_get_confidence(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"confidence\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_confidence_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_indicator_expression_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_expression_get_next_indicator_expression(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"indicator_expression\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_indicator_expression_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_expression_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_indicator_json:
 * @ptr: Pointer to an iodefv2_indicator_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_indicator_print_json(iodefv2_indicator_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_indicator_t\"");
        if ( ret < 0 )
                return ret;

        {
                int *i = iodefv2_indicator_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_indicator_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_indicator_get_ext_restriction(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_restriction\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_alternative_indicator_id_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_alternative_indicator_id(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"alternative_indicator_id\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_alternative_indicator_id_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_confidence_t *field;

                field = iodefv2_indicator_get_confidence(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"confidence\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_confidence_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_reference_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_reference(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"reference\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_reference_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_observable_t *field;

                field = iodefv2_indicator_get_observable(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_observable_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_indicator_expression_t *field;

                field = iodefv2_indicator_get_indicator_expression(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"indicator_expression\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_indicator_expression_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_contact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_contact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"contact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_contact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_node_role_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_node_role(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"node_role\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_node_role_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_indicator_get_start_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"start_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_indicator_id_t *field;

                field = iodefv2_indicator_get_indicator_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"indicator_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_indicator_id_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_indicator_reference_t *field;

                field = iodefv2_indicator_get_indicator_reference(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"indicator_reference\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_indicator_reference_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_observable_reference_t *field;

                field = iodefv2_indicator_get_observable_reference(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_reference\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_observable_reference_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_attack_phase_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_get_next_attack_phase(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"attack_phase\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_attack_phase_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_indicator_get_end_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"end_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_indicator_data_json:
 * @ptr: Pointer to an iodefv2_indicator_data_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_indicator_data_print_json(iodefv2_indicator_data_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_indicator_data_t\"");
        if ( ret < 0 )
                return ret;
{

                iodefv2_indicator_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_indicator_data_get_next_indicator(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"indicator\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_indicator_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_incident_json:
 * @ptr: Pointer to an iodefv2_incident_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_incident_print_json(iodefv2_incident_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_incident_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_incident_get_status(ptr);
{
                        const char *enumstr = iodefv2_incident_status_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"status\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                int *i = iodefv2_incident_get_lang(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_incident_lang_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"lang\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_get_ext_purpose(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_purpose\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int i = iodefv2_incident_get_purpose(ptr);
{
                        const char *enumstr = iodefv2_incident_purpose_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"purpose\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_get_ext_status(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"ext_status\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                int *i = iodefv2_incident_get_restriction(ptr);
                if ( i )
{
                        const char *enumstr = iodefv2_incident_restriction_to_string(*i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"restriction\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_get_observable_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"observable_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_history_t *field;

                field = iodefv2_incident_get_history(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"history\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_history_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_start_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"start_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_alternative_id_t *field;

                field = iodefv2_incident_get_alternative_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"alternative_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_alternative_id_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_contact_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_contact(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"contact\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_contact_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_related_activity_t *field;

                field = iodefv2_incident_get_related_activity(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"related_activity\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_related_activity_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_end_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"end_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_generation_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"generation_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_assessment_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_assessment(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"assessment\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_assessment_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_method_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_method(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"method\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_method_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_recovery_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"recovery_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_discovery_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_discovery(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"discovery\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_discovery_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_detect_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"detect_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                iodefv2_time_t *field;

                field = iodefv2_incident_get_report_time(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"report_time\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_time(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_incident_get_description(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"description\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_indicator_data_t *field;

                field = iodefv2_incident_get_indicator_data(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"indicator_data\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_indicator_data_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_event_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_incident_get_next_event_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"event_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_event_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }

{
                iodefv2_incident_id_t *field;

                field = iodefv2_incident_get_incident_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"incident_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = iodefv2_incident_id_print_json(field, fd);
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
/**
 * iodefv2_document_json:
 * @ptr: Pointer to an iodefv2_document_t object.
 *
 * This function will convert @ptr to a json,
 */
int iodefv2_document_print_json(iodefv2_document_t *ptr, libiodefv2_io_t *fd)
{
        int ret;

        if ( ! ptr )
                return 0;

        ret = do_write(fd, "{\"_self\": \"iodefv2_document_t\"");
        if ( ret < 0 )
                return ret;

        {
                int i = iodefv2_document_get_lang(ptr);
{
                        const char *enumstr = iodefv2_document_lang_to_string(i);

                        if ( enumstr ) {
                                ret = do_write(fd, ", \"lang\": \"");
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, enumstr);
                                if ( ret < 0 )
                                        return ret;

                                ret = do_write(fd, "\"");
                                if ( ret < 0 )
                                        return ret;
                        }
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_document_get_formatid(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"formatid\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_document_get_version(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"version\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_document_get_private_enum_name(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"private_enum_name\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }

        {
                libiodefv2_string_t *field;

                field = iodefv2_document_get_private_enum_id(ptr);
                if ( field ) {
                        ret = do_write(fd, ", \"private_enum_id\": ");
                        if ( ret < 0 )
                                return ret;

                        ret = conv_string(fd, field);
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_additional_data_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_document_get_next_additional_data(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"additional_data\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_additional_data_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
{

                iodefv2_incident_t *elem = NULL;
                int first = 1;

                while ( (elem = iodefv2_document_get_next_incident(ptr, elem)) ) {
                        if ( ! first )
                                ret = do_write(fd, ", ");
                        else {
                                first = 0;
                                ret = do_write(fd, ", \"incident\": [");
                        }

                        if ( ret < 0 )
                                return ret;
                        ret = iodefv2_incident_print_json(elem, fd);
                        if ( ret < 0 )
                                return ret;
 }

                if ( ! first ) {
                        ret = do_write(fd, "]");
                        if ( ret < 0 )
                                return ret;
                }
        }
return do_write(fd, "}");
}
